# Claude 작업 로그 - 2025년 9월 18일

## 프로젝트 개요
- **프로젝트명**: crypto-price-monitor
- **위치**: `/Users/iuo/Documents/EUOvaultSYNC/1 Project/privacy/crypto-price-monitor`
- **GitHub**: https://github.com/EUO-oma/crypto-price-monitor.git
- **브랜치**: main (기존 master에서 변경됨)

## 오늘 작업한 주요 내용

### 1. 코인 가격 달러 표시 변경
- BTC, ETH, SOL 가격에 검정색 달러 기호($) 추가
- `formatPrice` 함수 수정하여 달러 기호를 검정색으로 표시
- 커밋: 291f936

### 2. dual-chart.html 차트 로딩 문제 해결
**문제**: 모바일에서 페이지가 완전히 로드되기 전에 갱신이 발생하여 차트가 제대로 표시되지 않음

**첫 번째 시도** (커밋: 668cac5):
- 차트 로딩 추적 시스템 추가
- 모든 차트가 로드될 때까지 상호작용 비활성화
- onChartReady 콜백 추가

**두 번째 시도** (커밋: 4c6e242):
- 병렬 로딩에서 순차 로딩으로 변경
- 각 차트가 로드된 후에만 다음 차트 생성

**최종 해결** (커밋: 68cb463, e03cffe):
- 과거 안정적인 버전으로 롤백
- 0.1초 자동 갱신 기능이 있는 버전으로 복원
- 로컬 환경에서만 작동 (localhost, 127.0.0.1)

### 3. 채팅 UI 개선

**첫 번째 개선** (커밋: 8527fa9):
- 과거 성공적인 100% 너비 버전으로 교체
- 전송 버튼을 원형 디자인으로 변경 (SVG 화살표 아이콘)
- 채팅 컨테이너 패딩 15px로 증가
- 채팅 스크롤바 스타일 추가

**두 번째 개선** (커밋: 1ed1f4e):
- 메시지 너비를 `max-width: 70%`에서 `flex-grow: 1` 및 `width: calc(100% - 44px)`로 변경
- 카카오톡 스타일로 전체 너비 활용
- 26개의 다양한 코인 아바타 유지
- 아바타 맵핑 저장/로드 기능 추가
- 시간 표시를 메시지 오른쪽으로 이동

### 4. index.html 채팅 기능 추가
- 익명 채팅 섹션 추가
- 코인 아바타 시스템 구현
- 실시간 메시지 업데이트 (Supabase 연동)
- 브라우저 fingerprint 기반 사용자 식별

## 주요 파일 구조

### index.html
- 메인 대시보드 페이지
- 코인 가격 표시 (BTC, ETH, SOL)
- 실시간 채팅 기능
- Supabase 링크 관리 시스템

### dual-chart.html
- TradingView 위젯을 사용한 3개 차트 표시
- 레이아웃 옵션 (1: 세로 3분할, 2: 좌우 2분할, 3: 가로 3분할)
- 로컬 환경에서 0.1초 자동 갱신

## 기술 스택
- **프론트엔드**: 순수 HTML/CSS/JavaScript
- **실시간 데이터**: Binance WebSocket API
- **차트**: TradingView Widget
- **백엔드**: Supabase (링크 관리, 채팅 메시지)
- **배포**: Netlify

## 중요 설정 정보

### Supabase 설정
- 채팅 메시지는 `messages` 테이블 사용
- 링크는 `links` 테이블 사용
- 가격 기록은 `price_history` 테이블 사용

### Git 설정
- 기본 브랜치: main (master에서 변경)
- 모든 커밋에 Co-Authored-By: Claude 추가

## 채팅 시스템 상세

### 코인 아바타 목록
26개의 다양한 암호화폐 로고 사용:
- BTC, ETH, SOL, BNB, ADA, XRP, DOT, DOGE, AVAX, MATIC, LINK, UNI, ATOM, LTC, BCH, ALGO, XLM, ICP, FIL, ETC, TRON, THETA, AAVE, SHIB, FTM, EOS

### 브라우저 식별
- localStorage에 `persistent_browser_id` 저장
- 형식: `{디바이스타입}_{타임스탬프}_{랜덤문자열}`
- 예: `M_lz5k9m2_abc123` (모바일), `D_lz5k9m2_xyz789` (데스크탑)

### 메시지 레이아웃
- 내 메시지: 좌측 정렬, 회색 배경 (#1a1a1a)
- 다른 사람 메시지: 좌측 정렬, 검정 배경 (#000)
- 시간 표시: 메시지 오른쪽
- 최대 100개 메시지 유지

## 문제 해결 기록

### dual-chart.html 차트 로딩 문제
- **증상**: BTC 차트만 표시되고 ETH, SOL 차트가 로드되지 않음
- **원인**: 차트 로딩 중 페이지 갱신으로 인한 중단
- **해결**: 과거 안정적인 버전으로 롤백

### 채팅 텍스트 가시성 문제
- **증상**: 채팅 메시지가 검정색으로 표시되어 보이지 않음
- **원인**: 텍스트 색상 미지정
- **해결**: `color: #ffffff` 추가

## 향후 참고사항

1. **dual-chart.html의 0.1초 갱신**은 매우 공격적이므로 필요시 조정 검토
2. **채팅 시스템**은 Supabase 실시간 구독을 사용하므로 연결 상태 확인 필요
3. **코인 가격**은 Binance WebSocket을 사용하지만, 현재는 TradingView 위젯으로 표시
4. **브랜치**가 main으로 변경되었으므로 모든 연동 서비스 확인 필요

## 작업 환경
- macOS Darwin 24.5.0
- 작업 디렉토리: /Users/iuo/Documents/EUOvaultSYNC/1 Project/privacy/crypto-price-monitor
- Git 설정 필요: 사용자 이름과 이메일 설정 (`git config --global --edit`)

---
작성일: 2025년 9월 18일