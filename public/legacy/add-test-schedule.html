<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>테스트 일정 추가</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #121212;
            color: #fff;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        .section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
            background: #1e1e1e;
        }
        .success { border-color: #4caf50; }
        .error { border-color: #f44336; }
        .info { border-color: #2196f3; }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976d2; }
        button:disabled { background: #666; cursor: not-allowed; }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: 1px solid #444;
            background: #0d0d0d;
            color: #fff;
        }
        label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
        }
        .result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>테스트 일정 추가 도구</h1>
    
    <div class="section info">
        <h2>안내</h2>
        <p>이 페이지를 통해 테스트용 일정을 빠르게 추가할 수 있습니다.</p>
        <p>먼저 로그인이 필요합니다.</p>
    </div>
    
    <div id="authSection" class="section">
        <h2>1. 로그인</h2>
        <div id="authContent">
            <input type="email" id="email" placeholder="이메일" value="test@example.com">
            <input type="password" id="password" placeholder="비밀번호" value="test1234">
            <button onclick="login()">로그인</button>
            <button onclick="signup()">회원가입</button>
            <div id="authResult"></div>
        </div>
    </div>
    
    <div id="testDataSection" class="section" style="display: none;">
        <h2>2. 테스트 데이터 추가</h2>
        <button onclick="addSingleSchedule()">단일 일정 추가</button>
        <button onclick="addMultipleSchedules()">여러 일정 한번에 추가 (5개)</button>
        <button onclick="addCustomSchedule()">사용자 정의 일정 추가</button>
        
        <div id="customForm" style="display: none; margin-top: 20px;">
            <h3>사용자 정의 일정</h3>
            <label>제목</label>
            <input type="text" id="customTitle" value="내 일정">
            
            <label>설명</label>
            <textarea id="customDescription" rows="3">일정 설명을 입력하세요</textarea>
            
            <label>날짜</label>
            <input type="date" id="customDate" value="">
            
            <label>시간</label>
            <input type="time" id="customTime" value="10:00">
            
            <label>장소</label>
            <input type="text" id="customLocation" value="서울">
            
            <label>카테고리</label>
            <select id="customCategory">
                <option value="general">일반</option>
                <option value="meeting">회의</option>
                <option value="personal">개인</option>
                <option value="work">업무</option>
                <option value="family">가족</option>
                <option value="health">건강</option>
                <option value="education">교육</option>
                <option value="entertainment">엔터테인먼트</option>
            </select>
            
            <label>우선순위</label>
            <select id="customPriority">
                <option value="low">낮음</option>
                <option value="normal" selected>보통</option>
                <option value="high">높음</option>
                <option value="urgent">긴급</option>
            </select>
            
            <button onclick="submitCustomSchedule()" style="margin-top: 20px;">일정 추가</button>
        </div>
        
        <div id="results" style="margin-top: 20px;"></div>
    </div>
    
    <div class="section">
        <button onclick="location.href='/'">메인 페이지로 돌아가기</button>
        <button onclick="checkSchedules()">현재 일정 개수 확인</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://ddfnxbkiewolgweivomv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZm54YmtpZXdvbGd3ZWl2b212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MzI3NzYsImV4cCI6MjA2NzIwODc3Nn0.YCS2UH6YWarPX3C2ryFUUQnFA-3er_ZQomf_mccjmD8';
        
        let supabase;
        let currentUser = null;
        
        // 초기화
        window.addEventListener('load', async () => {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            
            // 현재 날짜 설정
            document.getElementById('customDate').value = new Date().toISOString().split('T')[0];
            
            // 로그인 상태 확인
            const { data: { user } } = await supabase.auth.getUser();
            if (user) {
                currentUser = user;
                showLoggedIn();
            }
        });
        
        function showResult(message, type) {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.style.background = type === 'success' ? 'rgba(76, 175, 80, 0.2)' : 'rgba(244, 67, 54, 0.2)';
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }
        
        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password
            });
            
            if (error) {
                document.getElementById('authResult').innerHTML = `<p style="color: #f44336;">로그인 실패: ${error.message}</p>`;
            } else {
                currentUser = data.user;
                showLoggedIn();
            }
        }
        
        async function signup() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            const { data, error } = await supabase.auth.signUp({
                email: email,
                password: password
            });
            
            if (error) {
                document.getElementById('authResult').innerHTML = `<p style="color: #f44336;">회원가입 실패: ${error.message}</p>`;
            } else {
                document.getElementById('authResult').innerHTML = `<p style="color: #4caf50;">회원가입 성공! 이메일을 확인해주세요.</p>`;
            }
        }
        
        function showLoggedIn() {
            document.getElementById('authContent').innerHTML = `
                <p style="color: #4caf50;">✅ 로그인됨: ${currentUser.email}</p>
                <button onclick="logout()">로그아웃</button>
            `;
            document.getElementById('testDataSection').style.display = 'block';
        }
        
        async function logout() {
            await supabase.auth.signOut();
            location.reload();
        }
        
        async function addSingleSchedule() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const schedule = {
                title: '테스트 일정',
                description: '이것은 테스트를 위한 일정입니다.',
                event_date: tomorrow.toISOString().split('T')[0],
                event_time: '14:00:00',
                location: '온라인',
                category: 'general',
                priority: 'normal',
                status: 'upcoming',
                color: '#2196f3',
                user_id: currentUser.id
            };
            
            const { error } = await supabase
                .from('schedules')
                .insert([schedule]);
            
            if (error) {
                showResult(`❌ 오류: ${error.message}`, 'error');
            } else {
                showResult('✅ 일정이 추가되었습니다!', 'success');
            }
        }
        
        async function addMultipleSchedules() {
            const schedules = [];
            const categories = ['general', 'meeting', 'personal', 'work', 'family'];
            const priorities = ['low', 'normal', 'high', 'urgent'];
            const colors = ['#2196f3', '#4caf50', '#ff9800', '#f44336', '#9c27b0'];
            
            for (let i = 0; i < 5; i++) {
                const date = new Date();
                date.setDate(date.getDate() + i);
                
                schedules.push({
                    title: `일정 ${i + 1} - ${['회의', '운동', '공부', '약속', '프로젝트'][i]}`,
                    description: `${i + 1}번째 테스트 일정입니다.`,
                    event_date: date.toISOString().split('T')[0],
                    event_time: `${10 + i}:00:00`,
                    location: ['서울', '부산', '온라인', '강남역', '집'][i],
                    category: categories[i % categories.length],
                    priority: priorities[i % priorities.length],
                    status: i === 0 ? 'ongoing' : 'upcoming',
                    color: colors[i % colors.length],
                    user_id: currentUser.id
                });
            }
            
            const { error } = await supabase
                .from('schedules')
                .insert(schedules);
            
            if (error) {
                showResult(`❌ 오류: ${error.message}`, 'error');
            } else {
                showResult('✅ 5개의 일정이 추가되었습니다!', 'success');
            }
        }
        
        function addCustomSchedule() {
            document.getElementById('customForm').style.display = 'block';
        }
        
        async function submitCustomSchedule() {
            const schedule = {
                title: document.getElementById('customTitle').value,
                description: document.getElementById('customDescription').value,
                event_date: document.getElementById('customDate').value,
                event_time: document.getElementById('customTime').value + ':00',
                location: document.getElementById('customLocation').value,
                category: document.getElementById('customCategory').value,
                priority: document.getElementById('customPriority').value,
                status: 'upcoming',
                color: '#2196f3',
                user_id: currentUser.id
            };
            
            const { error } = await supabase
                .from('schedules')
                .insert([schedule]);
            
            if (error) {
                showResult(`❌ 오류: ${error.message}`, 'error');
            } else {
                showResult('✅ 사용자 정의 일정이 추가되었습니다!', 'success');
                document.getElementById('customForm').style.display = 'none';
            }
        }
        
        async function checkSchedules() {
            const { data, error } = await supabase
                .from('schedules')
                .select('*', { count: 'exact' });
            
            if (error) {
                alert(`오류: ${error.message}`);
            } else {
                alert(`현재 총 ${data.length}개의 일정이 있습니다.`);
            }
        }
    </script>
</body>
</html>