<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…</title>
    <style>
        body {
            font-family: monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            background: #111;
            border: 1px solid #0f0;
            padding: 20px;
            margin: 20px 0;
        }
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #0a0;
        }
        pre {
            background: #000;
            padding: 10px;
            overflow-x: auto;
        }
        .error { color: #f00; }
        .success { color: #0f0; }
        .warning { color: #ff0; }
        .info { color: #0ff; }
    </style>
</head>
<body>
    <h1>ğŸ” ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹… ë„êµ¬</h1>
    
    <div class="section">
        <h2>1. ë¸Œë¼ìš°ì € ì •ë³´</h2>
        <pre id="browser-info"></pre>
    </div>
    
    <div class="section">
        <h2>2. ë„¤íŠ¸ì›Œí¬ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testAllEndpoints()">ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸</button>
        <pre id="network-log"></pre>
    </div>
    
    <div class="section">
        <h2>3. DNS ë° ì—°ê²°ì„± í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testDNS()">DNS í…ŒìŠ¤íŠ¸</button>
        <pre id="dns-log"></pre>
    </div>
    
    <div class="section">
        <h2>4. ëŒ€ì•ˆ ì†”ë£¨ì…˜</h2>
        <button onclick="showAlternatives()">ëŒ€ì•ˆ ë³´ê¸°</button>
        <pre id="alt-log"></pre>
    </div>

    <script>
        // ë¸Œë¼ìš°ì € ì •ë³´ í‘œì‹œ
        function showBrowserInfo() {
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                onLine: navigator.onLine,
                cookieEnabled: navigator.cookieEnabled,
                doNotTrack: navigator.doNotTrack,
                protocol: window.location.protocol,
                host: window.location.host || 'localhost',
                pathname: window.location.pathname,
                // ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
                secureContext: window.isSecureContext,
                // Service Worker ì§€ì›
                serviceWorkerSupported: 'serviceWorker' in navigator
            };
            
            document.getElementById('browser-info').textContent = JSON.stringify(info, null, 2);
            
            // ê²½ê³  í‘œì‹œ
            if (window.location.protocol === 'file:') {
                log('browser-info', '\nâš ï¸ file:// í”„ë¡œí† ì½œ ê°ì§€ë¨! http://localhost:8000 ì‚¬ìš© í•„ìš”', 'error');
            }
        }
        
        function log(targetId, message, type = 'info') {
            const el = document.getElementById(targetId);
            const time = new Date().toLocaleTimeString();
            el.innerHTML += `<span class="${type}">[${time}] ${message}</span>\n`;
        }
        
        // ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
        async function testAllEndpoints() {
            const logId = 'network-log';
            document.getElementById(logId).innerHTML = '';
            
            const endpoints = [
                {
                    name: 'Supabase Main',
                    url: 'https://intyabzhvtkxgldmvpvr.supabase.co',
                    method: 'HEAD'
                },
                {
                    name: 'Supabase REST API',
                    url: 'https://intyabzhvtkxgldmvpvr.supabase.co/rest/v1/',
                    headers: {
                        'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImludHlhYnpodnRreGdsZG12cHZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjkxODQwMTEsImV4cCI6MjA0NDc2MDAxMX0.mUgaLB6kQKvpsJ0L3n4cEBE_3S94BmdqYJoF-0K_vK0'
                    }
                },
                {
                    name: 'Google',
                    url: 'https://www.google.com/favicon.ico'
                },
                {
                    name: 'Cloudflare DNS',
                    url: 'https://1.1.1.1/favicon.ico'
                },
                {
                    name: 'GitHub API',
                    url: 'https://api.github.com'
                }
            ];
            
            for (const endpoint of endpoints) {
                try {
                    log(logId, `í…ŒìŠ¤íŠ¸: ${endpoint.name}...`);
                    
                    const options = {
                        method: endpoint.method || 'GET',
                        mode: 'cors',
                        cache: 'no-cache'
                    };
                    
                    if (endpoint.headers) {
                        options.headers = endpoint.headers;
                    }
                    
                    const startTime = performance.now();
                    const response = await fetch(endpoint.url, options);
                    const endTime = performance.now();
                    const duration = Math.round(endTime - startTime);
                    
                    log(logId, `  âœ“ ${endpoint.name}: ${response.status} (${duration}ms)`, 'success');
                    
                } catch (error) {
                    log(logId, `  âœ— ${endpoint.name}: ${error.message}`, 'error');
                    
                    // ìƒì„¸ ì˜¤ë¥˜ ë¶„ì„
                    if (error.message.includes('Load failed')) {
                        log(logId, '    â†’ ë„¤íŠ¸ì›Œí¬ ìˆ˜ì¤€ì—ì„œ ì°¨ë‹¨ë¨', 'error');
                    } else if (error.message.includes('CORS')) {
                        log(logId, '    â†’ CORS ì •ì±… ìœ„ë°˜', 'error');
                    } else if (error.message.includes('ERR_NAME_NOT_RESOLVED')) {
                        log(logId, '    â†’ DNS í•´ì„ ì‹¤íŒ¨', 'error');
                    }
                }
            }
        }
        
        // DNS í…ŒìŠ¤íŠ¸
        async function testDNS() {
            const logId = 'dns-log';
            document.getElementById(logId).innerHTML = '';
            
            log(logId, 'DNS ë° ì—°ê²°ì„± í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');
            
            // 1. navigator.connection ì •ë³´ (ì§€ì›í•˜ëŠ” ê²½ìš°)
            if ('connection' in navigator) {
                const conn = navigator.connection;
                log(logId, `\në„¤íŠ¸ì›Œí¬ íƒ€ì…: ${conn.effectiveType || 'unknown'}`);
                log(logId, `ë‹¤ìš´ë§í¬: ${conn.downlink || 'unknown'} Mbps`);
                log(logId, `RTT: ${conn.rtt || 'unknown'} ms`);
            }
            
            // 2. ì´ë¯¸ì§€ ë¡œë”© í…ŒìŠ¤íŠ¸
            log(logId, '\nì´ë¯¸ì§€ ë¡œë”© í…ŒìŠ¤íŠ¸:');
            const testUrls = [
                'https://intyabzhvtkxgldmvpvr.supabase.co/favicon.ico',
                'https://www.google.com/favicon.ico',
                'https://github.com/favicon.ico'
            ];
            
            for (const url of testUrls) {
                const img = new Image();
                const promise = new Promise((resolve, reject) => {
                    img.onload = () => resolve('loaded');
                    img.onerror = () => reject('failed');
                    setTimeout(() => reject('timeout'), 5000);
                });
                
                img.src = url;
                
                try {
                    await promise;
                    log(logId, `  âœ“ ${new URL(url).hostname}`, 'success');
                } catch (e) {
                    log(logId, `  âœ— ${new URL(url).hostname}: ${e}`, 'error');
                }
            }
            
            // 3. ê°€ëŠ¥í•œ ì›ì¸ ë¶„ì„
            log(logId, '\n\nğŸ” ê°€ëŠ¥í•œ ì›ì¸:', 'warning');
            log(logId, '1. ISPë‚˜ ë„¤íŠ¸ì›Œí¬ì—ì„œ Supabase ë„ë©”ì¸ ì°¨ë‹¨');
            log(logId, '2. DNS ì„œë²„ê°€ Supabase ë„ë©”ì¸ì„ í•´ì„í•˜ì§€ ëª»í•¨');
            log(logId, '3. ë°©í™”ë²½ì´ë‚˜ ë³´ì•ˆ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ì°¨ë‹¨');
            log(logId, '4. í”„ë¡ì‹œë‚˜ VPN ì„¤ì • ë¬¸ì œ');
            
            // 4. í•´ê²° ë°©ë²•
            log(logId, '\n\nğŸ’¡ ì‹œë„í•´ë³¼ ë°©ë²•:', 'success');
            log(logId, '1. DNS ì„œë²„ ë³€ê²½: 8.8.8.8 (Google) ë˜ëŠ” 1.1.1.1 (Cloudflare)');
            log(logId, '2. ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ë¡œ ì‹œë„ (ëª¨ë°”ì¼ í•«ìŠ¤íŒŸ ë“±)');
            log(logId, '3. VPN ì—°ê²°/í•´ì œ ì‹œë„');
            log(logId, '4. hosts íŒŒì¼ í™•ì¸: /etc/hosts');
        }
        
        // ëŒ€ì•ˆ ì†”ë£¨ì…˜
        function showAlternatives() {
            const logId = 'alt-log';
            document.getElementById(logId).innerHTML = '';
            
            log(logId, 'ğŸš€ ëŒ€ì•ˆ ì†”ë£¨ì…˜:', 'success');
            log(logId, '\n1. ë¡œì»¬ JSON ì„œë²„ ì‚¬ìš©:');
            log(logId, '   npm install -g json-server');
            log(logId, '   json-server --watch db.json');
            
            log(logId, '\n2. Firebase ì‚¬ìš©:');
            log(logId, '   Firebase Realtime DatabaseëŠ” ëŒ€ë¶€ë¶„ ì°¨ë‹¨ë˜ì§€ ì•ŠìŒ');
            
            log(logId, '\n3. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë¨¼ì € êµ¬í˜„:');
            log(logId, '   localStorageë¥¼ ì‚¬ìš©í•œ ì˜¤í”„ë¼ì¸ ë²„ì „ êµ¬í˜„');
            log(logId, '   ë‚˜ì¤‘ì— Supabaseì™€ ë™ê¸°í™”');
            
            log(logId, '\n4. ë°±ì—”ë“œ í”„ë¡ì‹œ ì„œë²„:');
            log(logId, '   ìì²´ ì„œë²„ë¥¼ í†µí•´ Supabase API ì¤‘ê³„');
            
            log(logId, '\n5. ë‹¤ë¥¸ Supabase í”„ë¡œì íŠ¸ ìƒì„±:');
            log(logId, '   ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ë¥¸ ë¦¬ì „ì— ìƒì„±');
            
            log(logId, '\n\nğŸ“‹ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ëŒ€ì•ˆ:', 'warning');
            log(logId, 'localStorage ê¸°ë°˜ ë²„ì „ì„ ë¨¼ì € ë§Œë“¤ê³ ,');
            log(logId, 'ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° í›„ Supabase ì—°ë™í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.');
        }
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            showBrowserInfo();
        });
    </script>
</body>
</html>