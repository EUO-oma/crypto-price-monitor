<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT Links Only</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            color: #ffffff;
            padding: 20px;
        }

        .container {
            background: #0a0a0a;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            margin: 0 auto;
            border: 1px solid #1a1a1a;
        }

        h1 {
            text-align: center;
            color: #4facfe;
            margin-bottom: 40px;
        }

        h2 {
            color: #aaa;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }

        .status {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .gpt-section {
            margin-top: 20px;
            padding-bottom: 20px;
        }

        #gpt-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .debug {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 10px;
            margin-top: 30px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– GPT Links Only Test</h1>
        
        <div id="status" class="status">ì´ˆê¸°í™” ì¤‘...</div>
        
        <div class="gpt-section">
            <h2>ğŸ¤– GPT Links</h2>
            <div id="gpt-links">
                <!-- GPT ë§í¬ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                <div style="color: #666;">ë¡œë”© ì¤‘...</div>
            </div>
        </div>
        
        <div id="debug-info" class="debug">ë””ë²„ê·¸ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
    </div>

    <!-- Supabase ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ë“¤ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // ë””ë²„ê·¸ ë¡œê·¸
        let debugLog = [];
        function log(message) {
            const time = new Date().toLocaleTimeString();
            const logMessage = `[${time}] ${message}`;
            console.log(logMessage);
            debugLog.push(logMessage);
            document.getElementById('debug-info').textContent = debugLog.join('\n');
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus(message, color = '#fff') {
            document.getElementById('status').innerHTML = `<span style="color: ${color}">${message}</span>`;
        }

        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(unsafe) {
            if (!unsafe) return '';
            return String(unsafe)
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // ìŠ¤íƒ€ì¼ ê°€ì ¸ì˜¤ê¸° (index.htmlì—ì„œ ë³µì‚¬)
        function getCardStyles(category) {
            const savedStyles = JSON.parse(localStorage.getItem('linkCardStyles') || '{}');
            const defaultStyles = {
                gpt: {
                    fontSize: 16, fontWeight: '500', bgColor: '#1a1a1a', textColor: '#ffffff',
                    borderColor: '#333333', borderWidth: 1, borderRadius: 10, padding: 15, gap: 10,
                    shadow: true, hoverEffect: true, hoverBg: '#2a2a2a', hoverScale: 102
                }
            };
            return { ...defaultStyles[category], ...(savedStyles[category] || {}) };
        }

        // GPT ë§í¬ë§Œ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
        async function loadGPTLinksOnly() {
            log('=== GPT Links ë¡œë”© ì‹œì‘ ===');
            updateStatus('Supabase ì´ˆê¸°í™” ì¤‘...', '#60a5fa');
            
            // Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ê¸°
            let attempts = 0;
            while (!window.supabase && attempts < 20) {
                log(`Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ê¸° ì¤‘... (${attempts + 1}/20)`);
                await new Promise(resolve => setTimeout(resolve, 200));
                attempts++;
            }
            
            if (!window.supabase) {
                log('âŒ Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨');
                updateStatus('âŒ Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨', '#f87171');
                return;
            }
            
            log('âœ… Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œë¨');
            
            try {
                // Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±
                const SUPABASE_URL = 'https://ddfnxbkiewolgweivomv.supabase.co';
                const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZm54YmtpZXdvbGd3ZWl2b212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MzI3NzYsImV4cCI6MjA2NzIwODc3Nn0.YCS2UH6YWarPX3C2ryFUUQnFA-3er_ZQomf_mccjmD8';
                
                const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                log('âœ… Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±ë¨');
                
                updateStatus('GPT ë§í¬ ì¡°íšŒ ì¤‘...', '#60a5fa');
                
                // GPT ë§í¬ë§Œ ì¡°íšŒ
                const { data: gptLinks, error } = await supabaseClient
                    .from('links')
                    .select('*')
                    .eq('category', 'gpt')
                    .order('position', { ascending: true });
                
                if (error) {
                    throw error;
                }
                
                log(`âœ… ${gptLinks?.length || 0}ê°œì˜ GPT ë§í¬ ì¡°íšŒë¨`);
                
                // GPT ë§í¬ ë Œë”ë§
                const gptContainer = document.getElementById('gpt-links');
                
                if (!gptLinks || gptLinks.length === 0) {
                    gptContainer.innerHTML = '<div style="color: #666; text-align: center;">GPT ë§í¬ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    updateStatus('GPT ë§í¬ê°€ ì—†ìŠµë‹ˆë‹¤', '#fbbf24');
                    return;
                }
                
                // ìŠ¤íƒ€ì¼ ê°€ì ¸ì˜¤ê¸°
                const gptStyles = getCardStyles('gpt');
                log('GPT ìŠ¤íƒ€ì¼: ' + JSON.stringify(gptStyles));
                
                // DOM ìš”ì†Œë¡œ ë§í¬ ìƒì„±
                gptContainer.innerHTML = ''; // ì´ˆê¸°í™”
                
                gptLinks.forEach((link, index) => {
                    log(`ë§í¬ ${index + 1}: ${link.name} - ${link.url}`);
                    
                    const linkElement = document.createElement('a');
                    linkElement.href = link.url || '#';
                    linkElement.target = '_blank';
                    linkElement.style.cssText = `
                        background: ${gptStyles.bgColor || '#1a1a1a'};
                        color: ${gptStyles.textColor || '#ffffff'};
                        padding: ${gptStyles.padding || 15}px;
                        border-radius: ${gptStyles.borderRadius || 10}px;
                        text-align: center;
                        border: 1px solid ${gptStyles.borderColor || '#333333'};
                        text-decoration: none;
                        transition: transform 0.3s ease;
                        display: block;
                    `;
                    
                    const textDiv = document.createElement('div');
                    textDiv.style.fontSize = `${gptStyles.fontSize || 16}px`;
                    textDiv.textContent = link.name || 'ì´ë¦„ ì—†ìŒ';
                    
                    linkElement.appendChild(textDiv);
                    
                    // í˜¸ë²„ ì´ë²¤íŠ¸
                    linkElement.addEventListener('mouseover', function() {
                        this.style.transform = 'translateY(-3px)';
                        this.style.borderColor = '#555';
                        if (gptStyles.hoverBg) {
                            this.style.background = gptStyles.hoverBg;
                        }
                    });
                    
                    linkElement.addEventListener('mouseout', function() {
                        this.style.transform = 'translateY(0)';
                        this.style.borderColor = gptStyles.borderColor || '#333333';
                        this.style.background = gptStyles.bgColor || '#1a1a1a';
                    });
                    
                    gptContainer.appendChild(linkElement);
                });
                
                updateStatus(`âœ… ${gptLinks.length}ê°œì˜ GPT ë§í¬ ë¡œë“œ ì™„ë£Œ`, '#4ade80');
                log('=== GPT Links ë Œë”ë§ ì™„ë£Œ ===');
                
            } catch (error) {
                log(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);
                updateStatus(`âŒ ì˜¤ë¥˜: ${error.message}`, '#f87171');
                
                const gptContainer = document.getElementById('gpt-links');
                gptContainer.innerHTML = `<div style="color: #f87171;">ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            
            // 1ì´ˆ í›„ ë§í¬ ë¡œë“œ ì‹œì‘
            setTimeout(() => {
                loadGPTLinksOnly();
            }, 1000);
        });

        // ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
        window.addEventListener('error', (event) => {
            log(`âŒ JavaScript ì˜¤ë¥˜: ${event.message}`);
        });
    </script>
</body>
</html>