<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì• ë‹ˆë©”ì´ì…˜ ì¶”ì²œ ë³´ë“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #fff;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            border-radius: 20px;
            border: 1px solid #333;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #e50914 0%, #ff6b6b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: #888;
            font-size: 1.1em;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .nav-tab {
            padding: 10px 20px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            color: #888;
        }

        .nav-tab.active {
            background: #e50914;
            border-color: #e50914;
            color: #fff;
            transform: translateY(-2px);
        }

        .nav-tab:hover {
            background: #2a2a2a;
            color: #fff;
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Form Styles */
        .form-container {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #333;
            margin-bottom: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #aaa;
            font-size: 0.9em;
            font-weight: 500;
        }

        label .required {
            color: #e50914;
        }

        input[type="text"],
        input[type="number"],
        input[type="url"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 1em;
            transition: all 0.3s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #e50914;
            box-shadow: 0 0 0 2px rgba(229, 9, 20, 0.2);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        select {
            cursor: pointer;
        }

        /* Star Rating */
        .star-rating {
            display: flex;
            gap: 5px;
            margin-top: 8px;
        }

        .star {
            font-size: 24px;
            color: #333;
            cursor: pointer;
            transition: all 0.2s;
        }

        .star:hover,
        .star.active {
            color: #ffd700;
            transform: scale(1.1);
        }

        /* Image Upload */
        .image-upload {
            margin-top: 8px;
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .image-item {
            position: relative;
            padding-top: 60%;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
        }

        .image-item img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.8);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .image-item .remove-btn:hover {
            background: #e50914;
            transform: scale(1.1);
        }

        /* Buttons */
        .btn {
            background: #e50914;
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .btn:hover {
            background: #f40612;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(229, 9, 20, 0.3);
        }

        .btn-secondary {
            background: #333;
        }

        .btn-secondary:hover {
            background: #444;
        }

        /* Anime List */
        .anime-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .anime-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .anime-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border-color: #e50914;
        }

        /* Edit/Delete buttons */
        .card-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .anime-card:hover .card-actions {
            opacity: 1;
        }

        .card-action-btn {
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 16px;
        }

        .card-action-btn:hover {
            transform: scale(1.1);
        }

        .card-action-btn.edit:hover {
            background: #4caf50;
        }

        .card-action-btn.delete:hover {
            background: #e50914;
        }

        .anime-poster {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: #0a0a0a;
        }

        .anime-info {
            padding: 20px;
        }

        .anime-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .anime-subtitle {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .anime-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.85em;
            color: #666;
        }

        .anime-platform {
            background: #e50914;
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            display: inline-block;
            margin-top: 10px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            max-width: 1000px;
            margin: 50px auto;
            background: #1a1a1a;
            border-radius: 20px;
            border: 1px solid #333;
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            position: relative;
            height: 300px;
            background: #0a0a0a;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }

        .modal-header img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.6;
        }

        .modal-header-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 30px;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
        }

        .modal-body {
            padding: 30px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 10;
        }

        .modal-close:hover {
            background: #e50914;
            transform: rotate(90deg);
        }

        .detail-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #333;
        }

        .detail-section:last-child {
            border-bottom: none;
        }

        .detail-section h3 {
            color: #e50914;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .detail-item {
            background: #0a0a0a;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #222;
        }

        .detail-label {
            color: #666;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .detail-value {
            color: #fff;
            font-size: 1em;
        }

        /* Screenshots Gallery */
        .screenshot-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .screenshot-item {
            position: relative;
            padding-top: 56.25%;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .screenshot-item:hover {
            transform: scale(1.05);
            border-color: #e50914;
        }

        .screenshot-item img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-left: 10px;
            border: 2px solid #333;
            border-top-color: #e50914;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        /* Status Messages */
        .status-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: #fff;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
            z-index: 2000;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .status-success {
            background: #4caf50;
        }

        .status-error {
            background: #f44336;
        }

        .status-warning {
            background: #ff9800;
        }

        /* Tag Input */
        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 8px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            min-height: 48px;
            align-items: center;
        }

        .tag {
            background: #e50914;
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tag .remove-tag {
            cursor: pointer;
            font-size: 16px;
        }

        .tag-input {
            border: none;
            background: none;
            outline: none;
            color: #fff;
            flex: 1;
            min-width: 100px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .modal-content {
                margin: 20px;
                border-radius: 15px;
            }

            .anime-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¬ ì• ë‹ˆë©”ì´ì…˜ ì¶”ì²œ ë³´ë“œ</h1>
            <p>ë„·í”Œë¦­ìŠ¤, ë””ì¦ˆë‹ˆ+ ë“±ì—ì„œ ë³¼ë§Œí•œ ì‘í’ˆë“¤ì„ ê³µìœ í•´ë³´ì„¸ìš”</p>
            <div id="auth-status" style="margin-top: 20px; text-align: center; color: #666;">
                <span id="auth-text">ë¡œê·¸ì¸í•˜ì§€ ì•ŠìŒ</span>
                <button id="auth-btn" class="btn btn-secondary" style="margin-left: 10px; padding: 8px 16px; font-size: 14px;" onclick="toggleAuth()">ë¡œê·¸ì¸</button>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('list')">
                <i class="fas fa-list"></i> ì‘í’ˆ ëª©ë¡
            </div>
            <div class="nav-tab" onclick="switchTab('add')">
                <i class="fas fa-plus"></i> ì‘í’ˆ ì¶”ê°€
            </div>
            <div class="nav-tab" onclick="switchTab('stats')">
                <i class="fas fa-chart-bar"></i> í†µê³„
            </div>
        </div>

        <!-- List Section -->
        <div class="section active" id="list-section">
            <div class="anime-grid" id="anime-grid">
                <div class="loading">ì‘í’ˆ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <!-- Add Section -->
        <div class="section" id="add-section">
            <div class="form-container">
                <h2 style="margin-bottom: 30px;" id="form-title">ìƒˆ ì‘í’ˆ ì¶”ê°€</h2>
                
                <!-- ChatGPT Helper Link -->
                <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 20px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px;">
                    <div style="flex: 1;">
                        <h4 style="color: #4caf50; margin-bottom: 8px;">ğŸ¤– AI ë¦¬ë·° ë„ìš°ë¯¸</h4>
                        <p style="color: #aaa; font-size: 0.9em; line-height: 1.5;">
                            ì‘í’ˆ ë¦¬ë·° ì‘ì„±ì— ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”? ChatGPTì˜ ì• ë‹ˆë©”ì´ì…˜ ë¦¬ë·° ì „ë¬¸ GPTë¥¼ í™œìš©í•´ë³´ì„¸ìš”!
                        </p>
                    </div>
                    <a href="https://chatgpt.com/g/g-68f46e6be61081918996e3c11448f17a-anime-review-gpt" 
                       target="_blank" 
                       class="btn btn-secondary"
                       style="white-space: nowrap;">
                        <i class="fas fa-robot"></i> ë¦¬ë·° ë„ìš°ë¯¸ ì—´ê¸°
                    </a>
                </div>
                
                <form id="anime-form">
                    <!-- ê¸°ë³¸ ì •ë³´ -->
                    <h3 style="color: #e50914; margin-bottom: 20px;">ğŸ“Œ ê¸°ë³¸ ì •ë³´</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì œëª© <span class="required">*</span></label>
                            <input type="text" id="title" required placeholder="ì˜ˆ: ìŠ¤íŒŒì´ë”ë§¨: ì–´í¬ë¡œìŠ¤ ë” ìŠ¤íŒŒì´ë”ë²„ìŠ¤">
                        </div>
                        
                        <div class="form-group">
                            <label>ë¶€ì œëª© / ì›ì œ</label>
                            <input type="text" id="subtitle" placeholder="ì˜ˆ: Spider-Man: Across the Spider-Verse">
                        </div>
                        
                        <div class="form-group">
                            <label>ì œì‘ë…„ë„ <span class="required">*</span></label>
                            <input type="number" id="year" required min="1900" max="2030" placeholder="2023">
                        </div>
                        
                        <div class="form-group">
                            <label>ì‹œì¦Œ/í™”ìˆ˜</label>
                            <input type="text" id="episodes" placeholder="ì˜ˆ: ì‹œì¦Œ 1 (12í™”)">
                        </div>
                        
                        <div class="form-group">
                            <label>í”Œë«í¼ <span class="required">*</span></label>
                            <select id="platform" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="ë„·í”Œë¦­ìŠ¤">ë„·í”Œë¦­ìŠ¤</option>
                                <option value="ë””ì¦ˆë‹ˆ+">ë””ì¦ˆë‹ˆ+</option>
                                <option value="ì™“ì± ">ì™“ì± </option>
                                <option value="ì›¨ì´ë¸Œ">ì›¨ì´ë¸Œ</option>
                                <option value="í‹°ë¹™">í‹°ë¹™</option>
                                <option value="ì• í”ŒTV+">ì• í”ŒTV+</option>
                                <option value="ì•„ë§ˆì¡´ í”„ë¼ì„">ì•„ë§ˆì¡´ í”„ë¼ì„</option>
                                <option value="ê·¹ì¥">ê·¹ì¥</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>ì¥ë¥´ (íƒœê·¸ í˜•ì‹)</label>
                            <div class="tag-input-container" id="genre-tags">
                                <input type="text" class="tag-input" placeholder="ì—”í„°í‚¤ë¡œ ì¶”ê°€" 
                                       onkeypress="handleTagInput(event, 'genre-tags')">
                            </div>
                        </div>
                    </div>

                    <!-- ì œì‘ ì •ë³´ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">ğŸ¬ ì œì‘ ì •ë³´</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ê°ë…</label>
                            <input type="text" id="director" placeholder="ì˜ˆ: í˜¸ì•„í‚´ ë„ìŠ¤ ì‚°í† ìŠ¤, ì¼í”„ íŒŒì›ŒìŠ¤">
                        </div>
                        
                        <div class="form-group">
                            <label>ì œì‘ì‚¬</label>
                            <input type="text" id="studio" placeholder="ì˜ˆ: ì†Œë‹ˆ í”½ì²˜ìŠ¤ ì• ë‹ˆë©”ì´ì…˜">
                        </div>
                        
                        <div class="form-group">
                            <label>ì›ì‘</label>
                            <input type="text" id="original" placeholder="ì˜ˆ: ë§ˆë¸” ì½”ë¯¹ìŠ¤">
                        </div>
                        
                        <div class="form-group">
                            <label>ì£¼ìš” ì„±ìš°/ì¶œì—°ì§„</label>
                            <input type="text" id="cast" placeholder="ì˜ˆ: ìƒ¤ë©”ìµ ë¬´ì–´, í—¤ì¼ë¦¬ ìŠ¤íƒ€ì¸í ë“œ">
                        </div>
                    </div>

                    <!-- í‰ê°€ ì •ë³´ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">â­ í‰ê°€ ì •ë³´</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>í‰ì </label>
                            <div class="star-rating" id="rating">
                                <span class="star" data-value="1">â˜†</span>
                                <span class="star" data-value="2">â˜†</span>
                                <span class="star" data-value="3">â˜†</span>
                                <span class="star" data-value="4">â˜†</span>
                                <span class="star" data-value="5">â˜†</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>ì¶”ì²œ ì—°ë ¹</label>
                            <select id="age_rating">
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="ì „ì²´">ì „ì²´ ê´€ëŒê°€</option>
                                <option value="7+">7ì„¸ ì´ìƒ</option>
                                <option value="12+">12ì„¸ ì´ìƒ</option>
                                <option value="15+">15ì„¸ ì´ìƒ</option>
                                <option value="19+">ì²­ì†Œë…„ ê´€ëŒë¶ˆê°€</option>
                            </select>
                        </div>
                    </div>

                    <!-- ìƒì„¸ ì •ë³´ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">ğŸ“ ìƒì„¸ ì •ë³´</h3>
                    <div class="form-group full-width">
                        <label>ì¤„ê±°ë¦¬</label>
                        <textarea id="synopsis" rows="4" placeholder="ì‘í’ˆì˜ ì¤„ê±°ë¦¬ë¥¼ ê°„ë‹¨íˆ ì†Œê°œí•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>ì‹œì²­ í¬ì¸íŠ¸</label>
                        <textarea id="highlights" rows="3" placeholder="ì´ ì‘í’ˆì˜ ë§¤ë ¥ì´ë‚˜ ì£¼ëª©í•  ë§Œí•œ ì ì„ ì•Œë ¤ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>ì¸ìƒ ê¹Šì€ ì¥ë©´</label>
                        <textarea id="memorable_scenes" rows="3" placeholder="íŠ¹ë³„íˆ ê¸°ì–µì— ë‚¨ëŠ” ì¥ë©´ì´ë‚˜ ì‹œí€€ìŠ¤ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>ëª…ëŒ€ì‚¬</label>
                        <textarea id="quotes" rows="3" placeholder="ê°ë™ì ì´ê±°ë‚˜ ì¸ìƒì ì¸ ëŒ€ì‚¬ë¥¼ ê³µìœ í•´ì£¼ì„¸ìš”"></textarea>
                    </div>

                    <!-- ìŠ¤íƒ€ì¼ ì •ë³´ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">ğŸ¨ ë¹„ì£¼ì–¼ & ìŠ¤íƒ€ì¼</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì‘í™” ìŠ¤íƒ€ì¼</label>
                            <input type="text" id="art_style" placeholder="ì˜ˆ: ì½”ë¯¹ë¶ ìŠ¤íƒ€ì¼, 2D/3D í˜¼í•©">
                        </div>
                        
                        <div class="form-group">
                            <label>ìƒ‰ê°/ë¶„ìœ„ê¸°</label>
                            <input type="text" id="color_mood" placeholder="ì˜ˆ: ë„¤ì˜¨ ì»¬ëŸ¬, ë‹¤í¬í†¤">
                        </div>
                        
                        <div class="form-group full-width">
                            <label>OST/ìŒì•…</label>
                            <textarea id="music" rows="2" placeholder="ì¸ìƒì ì¸ OSTë‚˜ ìŒì•…ì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"></textarea>
                        </div>
                    </div>

                    <!-- ë¯¸ë””ì–´ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">ğŸ–¼ï¸ ë¯¸ë””ì–´</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>í¬ìŠ¤í„° URL</label>
                            <input type="url" id="poster_url" placeholder="https://...">
                        </div>
                        
                        <div class="form-group">
                            <label>íŠ¸ë ˆì¼ëŸ¬ URL</label>
                            <input type="url" id="trailer_url" placeholder="https://youtube.com/...">
                        </div>
                        
                        <div class="form-group full-width">
                            <label>ìŠ¤í¬ë¦°ìƒ· (ìµœëŒ€ 5ì¥)</label>
                            <input type="file" id="screenshots" multiple accept="image/*" class="image-upload">
                            <div class="image-preview" id="screenshot-preview"></div>
                        </div>
                    </div>

                    <!-- ê°œì¸ ë©”ëª¨ -->
                    <h3 style="color: #e50914; margin: 30px 0 20px;">ğŸ’­ ê°œì¸ ê°ìƒ</h3>
                    <div class="form-group full-width">
                        <label>
                            ê°ìƒí‰ 
                            <a href="https://chatgpt.com/g/g-68f46e6be61081918996e3c11448f17a-anime-review-gpt" 
                               target="_blank" 
                               style="font-size: 0.8em; color: #4caf50; text-decoration: none; margin-left: 10px;">
                                (ğŸ¤– AI ë¦¬ë·° ë„ìš°ë¯¸)
                            </a>
                        </label>
                        <textarea id="review" rows="4" placeholder="ì‘í’ˆì„ ë³´ê³  ëŠë‚€ ê°œì¸ì ì¸ ê°ìƒì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>ì¶”ì²œ ëŒ€ìƒ</label>
                        <input type="text" id="recommend_to" placeholder="ì˜ˆ: íˆì–´ë¡œë¬¼ì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒ, ê°€ì¡±ê³¼ í•¨ê»˜ ë³´ê¸° ì¢‹ì€ ì‘í’ˆì„ ì°¾ëŠ” ì‚¬ëŒ">
                    </div>

                    <!-- Submit Buttons -->
                    <div style="margin-top: 40px;">
                        <button type="submit" class="btn" id="submit-btn">
                            <i class="fas fa-save"></i> <span id="submit-btn-text">ì‘í’ˆ ë“±ë¡</span>
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancel-edit-btn" style="display: none;" onclick="cancelEdit()">
                            <i class="fas fa-times"></i> ìˆ˜ì • ì·¨ì†Œ
                        </button>
                        <button type="reset" class="btn btn-secondary" onclick="resetForm()">
                            <i class="fas fa-undo"></i> ì´ˆê¸°í™”
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="section" id="stats-section">
            <div class="form-container">
                <h2>ğŸ“Š í†µê³„</h2>
                <div id="stats-content">
                    <div class="loading">í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal" id="detail-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div id="modal-content">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script>
        // Supabase configuration
        const SUPABASE_URL = 'https://ddfnxbkiewolgweivomv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZm54YmtpZXdvbGd3ZWl2b212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MzI3NzYsImV4cCI6MjA2NzIwODc3Nn0.YCS2UH6YWarPX3C2ryFUUQnFA-3er_ZQomf_mccjmD8';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global variables
        let selectedRating = 0;
        let genreTags = [];
        let screenshotFiles = [];
        let animeList = [];
        let currentUser = null;
        let editingId = null;

        // Initialize
        async function init() {
            setupEventListeners();
            
            // Check for OAuth callback
            if (window.location.hash && window.location.hash.includes('access_token')) {
                console.log('OAuth ì½œë°± ì²˜ë¦¬ ì¤‘...');
                // Supabaseê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ëŒ€ê¸°
                setTimeout(async () => {
                    await checkAuth();
                    await loadAnimeList();
                    // Clear the hash
                    window.history.replaceState(null, '', window.location.pathname);
                }, 1000);
            } else {
                await checkAuth();
                await loadAnimeList();
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Star rating
            document.querySelectorAll('.star').forEach(star => {
                star.addEventListener('click', function() {
                    selectedRating = parseInt(this.dataset.value);
                    updateStarRating();
                });
            });

            // Form submission
            document.getElementById('anime-form').addEventListener('submit', handleSubmit);

            // Screenshot upload
            document.getElementById('screenshots').addEventListener('change', handleScreenshots);
        }

        // Update star rating display
        function updateStarRating() {
            document.querySelectorAll('.star').forEach((star, index) => {
                if (index < selectedRating) {
                    star.textContent = 'â˜…';
                    star.classList.add('active');
                } else {
                    star.textContent = 'â˜†';
                    star.classList.remove('active');
                }
            });
        }

        // Switch tabs
        function switchTab(tab) {
            // Check if user is authenticated for 'add' tab
            if (tab === 'add' && !currentUser) {
                showStatus('ì‘í’ˆì„ ì¶”ê°€í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                loginWithGoogle();
                return;
            }
            
            // If switching away from add tab while editing, cancel edit
            if (tab !== 'add' && editingId !== null) {
                cancelEdit();
            }
            
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.closest('.nav-tab').classList.add('active');
            } else {
                // For programmatic tab switching
                document.querySelectorAll('.nav-tab').forEach((t, index) => {
                    if ((tab === 'list' && index === 0) || (tab === 'add' && index === 1) || (tab === 'stats' && index === 2)) {
                        t.classList.add('active');
                    }
                });
            }

            // Update sections
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(`${tab}-section`).classList.add('active');

            // Load content if needed
            if (tab === 'list') {
                loadAnimeList();
            } else if (tab === 'stats') {
                loadStats();
            }
        }

        // Handle tag input
        function handleTagInput(event, containerId) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const input = event.target;
                const value = input.value.trim();
                
                if (value && !genreTags.includes(value)) {
                    genreTags.push(value);
                    renderTags(containerId);
                    input.value = '';
                }
            }
        }

        // Render tags
        function renderTags(containerId) {
            const container = document.getElementById(containerId);
            const existingTags = container.querySelectorAll('.tag');
            existingTags.forEach(tag => tag.remove());

            genreTags.forEach((tag, index) => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag';
                tagElement.innerHTML = `
                    ${tag}
                    <span class="remove-tag" onclick="removeTag(${index}, '${containerId}')">&times;</span>
                `;
                container.insertBefore(tagElement, container.querySelector('.tag-input'));
            });
        }

        // Remove tag
        function removeTag(index, containerId) {
            genreTags.splice(index, 1);
            renderTags(containerId);
        }

        // Handle screenshot upload
        function handleScreenshots(event) {
            const files = Array.from(event.target.files).slice(0, 5);
            screenshotFiles = files;
            
            const preview = document.getElementById('screenshot-preview');
            preview.innerHTML = '';
            
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const item = document.createElement('div');
                    item.className = 'image-item';
                    item.innerHTML = `
                        <img src="${e.target.result}" alt="Screenshot ${index + 1}">
                        <button class="remove-btn" onclick="removeScreenshot(${index})">&times;</button>
                    `;
                    preview.appendChild(item);
                };
                reader.readAsDataURL(file);
            });
        }

        // Remove screenshot
        function removeScreenshot(index) {
            screenshotFiles.splice(index, 1);
            const input = document.getElementById('screenshots');
            const dt = new DataTransfer();
            screenshotFiles.forEach(file => dt.items.add(file));
            input.files = dt.files;
            handleScreenshots({ target: input });
        }

        // Handle form submission
        async function handleSubmit(event) {
            event.preventDefault();
            
            // Check authentication first
            if (!currentUser) {
                showStatus('ì‘í’ˆì„ ì¶”ê°€í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                loginWithGoogle();
                return;
            }
            
            try {
                const isEditing = editingId !== null;
                showStatus(isEditing ? 'ì‘í’ˆì„ ìˆ˜ì •í•˜ëŠ” ì¤‘...' : 'ì‘í’ˆì„ ë“±ë¡í•˜ëŠ” ì¤‘...', 'warning');
                
                // Collect form data
                const formData = {
                    title: document.getElementById('title').value,
                    subtitle: document.getElementById('subtitle').value,
                    year: parseInt(document.getElementById('year').value),
                    episodes: document.getElementById('episodes').value,
                    platform: document.getElementById('platform').value,
                    genres: genreTags,
                    director: document.getElementById('director').value,
                    studio: document.getElementById('studio').value,
                    original: document.getElementById('original').value,
                    cast_info: document.getElementById('cast').value,
                    rating: selectedRating,
                    age_rating: document.getElementById('age_rating').value,
                    synopsis: document.getElementById('synopsis').value,
                    highlights: document.getElementById('highlights').value,
                    memorable_scenes: document.getElementById('memorable_scenes').value,
                    quotes: document.getElementById('quotes').value,
                    art_style: document.getElementById('art_style').value,
                    color_mood: document.getElementById('color_mood').value,
                    music: document.getElementById('music').value,
                    poster_url: document.getElementById('poster_url').value,
                    trailer_url: document.getElementById('trailer_url').value,
                    review: document.getElementById('review').value,
                    recommend_to: document.getElementById('recommend_to').value
                };

                // Add user_id and created_at for new entries
                if (!isEditing) {
                    formData.user_id = currentUser.id;
                    formData.created_at = new Date().toISOString();
                }

                // Upload screenshots if any
                if (screenshotFiles.length > 0) {
                    const screenshotUrls = [];
                    for (const file of screenshotFiles) {
                        const fileName = `${Date.now()}_${file.name}`;
                        const { data, error } = await supabase.storage
                            .from('anime-screenshots')
                            .upload(fileName, file);
                        
                        if (!error) {
                            const { data: publicUrl } = supabase.storage
                                .from('anime-screenshots')
                                .getPublicUrl(fileName);
                            screenshotUrls.push(publicUrl.publicUrl);
                        }
                    }
                    formData.screenshots = screenshotUrls;
                }

                // Insert or update in database
                if (isEditing) {
                    const { data, error } = await supabase
                        .from('anime_board')
                        .update(formData)
                        .eq('id', editingId)
                        .eq('user_id', currentUser.id) // Ensure user can only edit their own content
                        .select();
                    
                    if (error) throw error;
                    showStatus('ì‘í’ˆì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                } else {
                    const { data, error } = await supabase
                        .from('anime_board')
                        .insert([formData])
                        .select();
                    
                    if (error) throw error;
                    showStatus('ì‘í’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                }
                
                cancelEdit(); // This will also reset the form
                switchTab('list');
                
            } catch (error) {
                console.error('Error:', error);
                showStatus(editingId ? 'ì‘í’ˆ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message : 'ì‘í’ˆ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }

        // Load anime list
        async function loadAnimeList() {
            try {
                const { data, error } = await supabase
                    .from('anime_board')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                animeList = data || [];
                renderAnimeList();
                
            } catch (error) {
                console.error('Error loading anime:', error);
                document.getElementById('anime-grid').innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-film"></i>
                        <p>ì‘í’ˆì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                    </div>
                `;
            }
        }

        // Render anime list
        function renderAnimeList() {
            const grid = document.getElementById('anime-grid');
            
            if (animeList.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-film"></i>
                        <h3>ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ì²« ë²ˆì§¸ ì‘í’ˆì„ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = animeList.map(anime => `
                <div class="anime-card">
                    ${currentUser && anime.user_id === currentUser.id ? `
                        <div class="card-actions">
                            <button class="card-action-btn edit" onclick="event.stopPropagation(); editAnime('${anime.id}')" title="ìˆ˜ì •">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="card-action-btn delete" onclick="event.stopPropagation(); deleteAnime('${anime.id}')" title="ì‚­ì œ">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    ` : ''}
                    <div onclick="showDetail('${anime.id}')" style="height: 100%;">
                        ${anime.poster_url ? 
                            `<img src="${anime.poster_url}" alt="${anime.title}" class="anime-poster">` :
                            `<div class="anime-poster" style="display: flex; align-items: center; justify-content: center; font-size: 3em; color: #333;">
                                <i class="fas fa-film"></i>
                            </div>`
                        }
                        <div class="anime-info">
                            <h3 class="anime-title">${anime.title}</h3>
                            ${anime.subtitle ? `<p class="anime-subtitle">${anime.subtitle}</p>` : ''}
                            <div class="anime-meta">
                                <span>${anime.year}</span>
                                ${anime.episodes ? `<span>${anime.episodes}</span>` : ''}
                                ${anime.rating ? `<span>${'â˜…'.repeat(anime.rating)}${'â˜†'.repeat(5 - anime.rating)}</span>` : ''}
                            </div>
                            <div class="anime-platform">${anime.platform}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Show detail modal
        function showDetail(id) {
            const anime = animeList.find(a => a.id === id);
            if (!anime) return;
            
            const modal = document.getElementById('detail-modal');
            const content = document.getElementById('modal-content');
            
            content.innerHTML = `
                <div class="modal-header">
                    ${anime.poster_url ? `<img src="${anime.poster_url}" alt="${anime.title}">` : ''}
                    <div class="modal-header-content">
                        <h1>${anime.title}</h1>
                        ${anime.subtitle ? `<p style="color: #aaa; margin-top: 5px;">${anime.subtitle}</p>` : ''}
                        <div style="margin-top: 15px; display: flex; gap: 15px; flex-wrap: wrap;">
                            <span style="background: ${getPlatformColor(anime.platform)}; color: #fff; padding: 6px 15px; border-radius: 20px;">
                                ${anime.platform}
                            </span>
                            ${anime.year ? `<span>${anime.year}</span>` : ''}
                            ${anime.episodes ? `<span>${anime.episodes}</span>` : ''}
                            ${anime.age_rating ? `<span>${anime.age_rating}</span>` : ''}
                        </div>
                    </div>
                </div>
                
                <div class="modal-body">
                    <!-- í‰ì  ë° ì¥ë¥´ -->
                    ${anime.rating || anime.genres?.length ? `
                    <div class="detail-section">
                        ${anime.rating ? `
                        <h3>í‰ì </h3>
                        <p style="font-size: 2em; color: #ffd700;">
                            ${'â˜…'.repeat(anime.rating)}${'â˜†'.repeat(5 - anime.rating)}
                            <span style="font-size: 0.6em; color: #888; margin-left: 10px;">${anime.rating}/5</span>
                        </p>
                        ` : ''}
                        ${anime.genres?.length ? `
                        <div style="margin-top: 20px;">
                            ${anime.genres.map(genre => `
                                <span class="tag" style="margin-right: 8px;">${genre}</span>
                            `).join('')}
                        </div>
                        ` : ''}
                    </div>
                    ` : ''}
                    
                    <!-- ì œì‘ ì •ë³´ -->
                    ${anime.director || anime.studio || anime.original || anime.cast_info ? `
                    <div class="detail-section">
                        <h3>ì œì‘ ì •ë³´</h3>
                        <div class="detail-grid">
                            ${anime.director ? `
                            <div class="detail-item">
                                <div class="detail-label">ê°ë…</div>
                                <div class="detail-value">${anime.director}</div>
                            </div>
                            ` : ''}
                            ${anime.studio ? `
                            <div class="detail-item">
                                <div class="detail-label">ì œì‘ì‚¬</div>
                                <div class="detail-value">${anime.studio}</div>
                            </div>
                            ` : ''}
                            ${anime.original ? `
                            <div class="detail-item">
                                <div class="detail-label">ì›ì‘</div>
                                <div class="detail-value">${anime.original}</div>
                            </div>
                            ` : ''}
                            ${anime.cast_info ? `
                            <div class="detail-item" style="grid-column: 1 / -1;">
                                <div class="detail-label">ì£¼ìš” ì„±ìš°/ì¶œì—°ì§„</div>
                                <div class="detail-value">${anime.cast_info}</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ì¤„ê±°ë¦¬ -->
                    ${anime.synopsis ? `
                    <div class="detail-section">
                        <h3>ì¤„ê±°ë¦¬</h3>
                        <p style="line-height: 1.8; color: #ccc;">${anime.synopsis}</p>
                    </div>
                    ` : ''}
                    
                    <!-- ì‹œì²­ í¬ì¸íŠ¸ -->
                    ${anime.highlights ? `
                    <div class="detail-section">
                        <h3>ì‹œì²­ í¬ì¸íŠ¸</h3>
                        <p style="line-height: 1.8; color: #ccc;">${anime.highlights}</p>
                    </div>
                    ` : ''}
                    
                    <!-- ì¸ìƒ ê¹Šì€ ì¥ë©´ & ëª…ëŒ€ì‚¬ -->
                    ${anime.memorable_scenes || anime.quotes ? `
                    <div class="detail-section">
                        ${anime.memorable_scenes ? `
                        <h3>ì¸ìƒ ê¹Šì€ ì¥ë©´</h3>
                        <p style="line-height: 1.8; color: #ccc; margin-bottom: 20px;">${anime.memorable_scenes}</p>
                        ` : ''}
                        ${anime.quotes ? `
                        <h3>ëª…ëŒ€ì‚¬</h3>
                        <blockquote style="border-left: 3px solid #e50914; padding-left: 20px; margin: 15px 0; font-style: italic; color: #ccc;">
                            ${anime.quotes}
                        </blockquote>
                        ` : ''}
                    </div>
                    ` : ''}
                    
                    <!-- ë¹„ì£¼ì–¼ & ìŠ¤íƒ€ì¼ -->
                    ${anime.art_style || anime.color_mood || anime.music ? `
                    <div class="detail-section">
                        <h3>ë¹„ì£¼ì–¼ & ìŠ¤íƒ€ì¼</h3>
                        <div class="detail-grid">
                            ${anime.art_style ? `
                            <div class="detail-item">
                                <div class="detail-label">ì‘í™” ìŠ¤íƒ€ì¼</div>
                                <div class="detail-value">${anime.art_style}</div>
                            </div>
                            ` : ''}
                            ${anime.color_mood ? `
                            <div class="detail-item">
                                <div class="detail-label">ìƒ‰ê°/ë¶„ìœ„ê¸°</div>
                                <div class="detail-value">${anime.color_mood}</div>
                            </div>
                            ` : ''}
                            ${anime.music ? `
                            <div class="detail-item" style="grid-column: 1 / -1;">
                                <div class="detail-label">OST/ìŒì•…</div>
                                <div class="detail-value">${anime.music}</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ìŠ¤í¬ë¦°ìƒ· ê°¤ëŸ¬ë¦¬ -->
                    ${anime.screenshots?.length ? `
                    <div class="detail-section">
                        <h3>ìŠ¤í¬ë¦°ìƒ·</h3>
                        <div class="screenshot-gallery">
                            ${anime.screenshots.map((url, index) => `
                                <div class="screenshot-item" onclick="window.open('${url}', '_blank')">
                                    <img src="${url}" alt="Screenshot ${index + 1}">
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ê°œì¸ ê°ìƒ -->
                    ${anime.review || anime.recommend_to ? `
                    <div class="detail-section">
                        <h3>ê°ìƒí‰</h3>
                        ${anime.review ? `
                        <p style="line-height: 1.8; color: #ccc; margin-bottom: 20px;">${anime.review}</p>
                        ` : ''}
                        ${anime.recommend_to ? `
                        <div class="detail-item">
                            <div class="detail-label">ì¶”ì²œ ëŒ€ìƒ</div>
                            <div class="detail-value">${anime.recommend_to}</div>
                        </div>
                        ` : ''}
                    </div>
                    ` : ''}
                    
                    <!-- íŠ¸ë ˆì¼ëŸ¬ ë§í¬ -->
                    ${anime.trailer_url ? `
                    <div class="detail-section">
                        <a href="${anime.trailer_url}" target="_blank" class="btn" style="width: 100%; text-align: center;">
                            <i class="fas fa-play"></i> íŠ¸ë ˆì¼ëŸ¬ ë³´ê¸°
                        </a>
                    </div>
                    ` : ''}
                </div>
            `;
            
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('detail-modal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Reset form
        function resetForm() {
            document.getElementById('anime-form').reset();
            selectedRating = 0;
            genreTags = [];
            screenshotFiles = [];
            updateStarRating();
            renderTags('genre-tags');
            document.getElementById('screenshot-preview').innerHTML = '';
        }

        // Edit anime
        async function editAnime(id) {
            const anime = animeList.find(a => a.id === id);
            if (!anime || anime.user_id !== currentUser.id) {
                showStatus('ì´ ì‘í’ˆì„ ìˆ˜ì •í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            editingId = id;
            
            // Update UI
            document.getElementById('form-title').textContent = 'ì‘í’ˆ ìˆ˜ì •';
            document.getElementById('submit-btn-text').textContent = 'ì‘í’ˆ ìˆ˜ì •';
            document.getElementById('cancel-edit-btn').style.display = 'inline-block';
            
            // Load data into form
            document.getElementById('title').value = anime.title || '';
            document.getElementById('subtitle').value = anime.subtitle || '';
            document.getElementById('year').value = anime.year || '';
            document.getElementById('episodes').value = anime.episodes || '';
            document.getElementById('platform').value = anime.platform || '';
            document.getElementById('director').value = anime.director || '';
            document.getElementById('studio').value = anime.studio || '';
            document.getElementById('original').value = anime.original || '';
            document.getElementById('cast').value = anime.cast_info || '';
            document.getElementById('age_rating').value = anime.age_rating || '';
            document.getElementById('synopsis').value = anime.synopsis || '';
            document.getElementById('highlights').value = anime.highlights || '';
            document.getElementById('memorable_scenes').value = anime.memorable_scenes || '';
            document.getElementById('quotes').value = anime.quotes || '';
            document.getElementById('art_style').value = anime.art_style || '';
            document.getElementById('color_mood').value = anime.color_mood || '';
            document.getElementById('music').value = anime.music || '';
            document.getElementById('poster_url').value = anime.poster_url || '';
            document.getElementById('trailer_url').value = anime.trailer_url || '';
            document.getElementById('review').value = anime.review || '';
            document.getElementById('recommend_to').value = anime.recommend_to || '';
            
            // Load genres
            genreTags = anime.genres || [];
            renderTags('genre-tags');
            
            // Load rating
            selectedRating = anime.rating || 0;
            updateStarRating();
            
            // Switch to edit tab
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-tab')[1].classList.add('active');
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('add-section').classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Delete anime
        async function deleteAnime(id) {
            const anime = animeList.find(a => a.id === id);
            if (!anime || anime.user_id !== currentUser.id) {
                showStatus('ì´ ì‘í’ˆì„ ì‚­ì œí•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            if (!confirm(`ì •ë§ë¡œ "${anime.title}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            try {
                showStatus('ì‘í’ˆì„ ì‚­ì œí•˜ëŠ” ì¤‘...', 'warning');
                
                const { error } = await supabase
                    .from('anime_board')
                    .delete()
                    .eq('id', id)
                    .eq('user_id', currentUser.id);
                
                if (error) throw error;
                
                showStatus('ì‘í’ˆì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                await loadAnimeList();
                
            } catch (error) {
                console.error('Error deleting anime:', error);
                showStatus('ì‘í’ˆ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }

        // Cancel edit
        function cancelEdit() {
            editingId = null;
            document.getElementById('form-title').textContent = 'ìƒˆ ì‘í’ˆ ì¶”ê°€';
            document.getElementById('submit-btn-text').textContent = 'ì‘í’ˆ ë“±ë¡';
            document.getElementById('cancel-edit-btn').style.display = 'none';
            resetForm();
        }

        // Load stats
        async function loadStats() {
            const statsContent = document.getElementById('stats-content');
            
            try {
                const { data, error } = await supabase
                    .from('anime_board')
                    .select('*');
                
                if (error) throw error;
                
                // Calculate stats
                const totalAnime = data.length;
                const platformCounts = {};
                const genreCounts = {};
                const yearCounts = {};
                let totalRating = 0;
                let ratedCount = 0;
                
                data.forEach(anime => {
                    // Platform stats
                    platformCounts[anime.platform] = (platformCounts[anime.platform] || 0) + 1;
                    
                    // Genre stats
                    if (anime.genres) {
                        anime.genres.forEach(genre => {
                            genreCounts[genre] = (genreCounts[genre] || 0) + 1;
                        });
                    }
                    
                    // Year stats
                    if (anime.year) {
                        yearCounts[anime.year] = (yearCounts[anime.year] || 0) + 1;
                    }
                    
                    // Rating stats
                    if (anime.rating) {
                        totalRating += anime.rating;
                        ratedCount++;
                    }
                });
                
                const averageRating = ratedCount > 0 ? (totalRating / ratedCount).toFixed(1) : 0;
                
                // Render stats
                statsContent.innerHTML = `
                    <div class="detail-grid" style="margin-top: 30px;">
                        <div class="detail-item">
                            <div class="detail-label">ì´ ì‘í’ˆ ìˆ˜</div>
                            <div class="detail-value" style="font-size: 2em;">${totalAnime}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">í‰ê·  í‰ì </div>
                            <div class="detail-value" style="font-size: 2em; color: #ffd700;">
                                ${averageRating} / 5
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px;">í”Œë«í¼ë³„ ë¶„í¬</h3>
                    <div class="detail-grid">
                        ${Object.entries(platformCounts)
                            .sort((a, b) => b[1] - a[1])
                            .map(([platform, count]) => `
                                <div class="detail-item">
                                    <div class="detail-label">${platform}</div>
                                    <div class="detail-value">${count} ì‘í’ˆ</div>
                                </div>
                            `).join('')}
                    </div>
                    
                    ${Object.keys(genreCounts).length > 0 ? `
                    <h3 style="margin-top: 30px;">ì¥ë¥´ë³„ ë¶„í¬</h3>
                    <div style="margin-top: 15px;">
                        ${Object.entries(genreCounts)
                            .sort((a, b) => b[1] - a[1])
                            .slice(0, 10)
                            .map(([genre, count]) => `
                                <span class="tag" style="margin: 5px;">
                                    ${genre} (${count})
                                </span>
                            `).join('')}
                    </div>
                    ` : ''}
                `;
                
            } catch (error) {
                console.error('Error loading stats:', error);
                statsContent.innerHTML = '<p style="color: #666;">í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>';
            }
        }

        // Get platform color
        function getPlatformColor(platform) {
            const colors = {
                'ë„·í”Œë¦­ìŠ¤': '#e50914',
                'ë””ì¦ˆë‹ˆ+': '#1a5eff',
                'ì™“ì± ': '#ff0558',
                'ì›¨ì´ë¸Œ': '#1f4ef5',
                'í‹°ë¹™': '#ff153c',
                'ì• í”ŒTV+': '#000000',
                'ì•„ë§ˆì¡´ í”„ë¼ì„': '#00a8e1',
                'ê·¹ì¥': '#ffd700',
                'ê¸°íƒ€': '#666666'
            };
            return colors[platform] || '#666666';
        }

        // Show status message
        function showStatus(message, type) {
            const existing = document.querySelector('.status-message');
            if (existing) existing.remove();
            
            const status = document.createElement('div');
            status.className = `status-message status-${type}`;
            status.textContent = message;
            document.body.appendChild(status);
            
            setTimeout(() => {
                status.remove();
            }, 3000);
        }

        // Click outside modal to close
        window.onclick = function(event) {
            const modal = document.getElementById('detail-modal');
            if (event.target === modal) {
                closeModal();
            }
        };

        // Check authentication
        async function checkAuth() {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                currentUser = user;
                updateAuthUI();
            } catch (error) {
                console.error('Auth check error:', error);
            }
        }

        // Update auth UI
        function updateAuthUI() {
            const authText = document.getElementById('auth-text');
            const authBtn = document.getElementById('auth-btn');
            
            if (currentUser) {
                authText.textContent = `ë¡œê·¸ì¸ë¨: ${currentUser.email}`;
                authBtn.textContent = 'ë¡œê·¸ì•„ì›ƒ';
            } else {
                authText.textContent = 'ë¡œê·¸ì¸í•˜ì§€ ì•ŠìŒ';
                authBtn.textContent = 'ë¡œê·¸ì¸';
            }
        }

        // Toggle authentication
        async function toggleAuth() {
            if (currentUser) {
                // Logout
                await supabase.auth.signOut();
                currentUser = null;
                updateAuthUI();
                showStatus('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                // Switch to list tab if on add tab
                const activeTab = document.querySelector('.nav-tab.active');
                if (activeTab && activeTab.textContent.includes('ì‘í’ˆ ì¶”ê°€')) {
                    switchTab('list');
                }
            } else {
                // Login with Google directly
                loginWithGoogle();
            }
        }

        // Googleë¡œ ë¡œê·¸ì¸
        async function loginWithGoogle() {
            try {
                showStatus('Google ë¡œê·¸ì¸ ì¤‘...', 'warning');
                
                const { data, error } = await supabase.auth.signInWithOAuth({
                    provider: 'google',
                    options: {
                        redirectTo: window.location.href.split('?')[0].split('#')[0],
                        queryParams: {
                            access_type: 'offline',
                            prompt: 'consent'
                        },
                        skipBrowserRedirect: false
                    }
                });
                
                if (error) throw error;
                
                // OAuthëŠ” ìë™ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¨
                
            } catch (error) {
                console.error('Google ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                showStatus('Google ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + error.message, 'error');
            }
        }
        
        // Listen for auth changes
        supabase?.auth.onAuthStateChange((event, session) => {
            currentUser = session?.user || null;
            updateAuthUI();
        });

        // Initialize on load
        window.addEventListener('load', init);
    </script>
</body>
</html>