<!DOCTYPE html>
<!--
    CRYPTO √ó LIVE MONITOR
    
    Branch Update Notice (2025-09-18):
    - Ïù¥ ÌîÑÎ°úÏ†ùÌä∏Îäî Ïù¥Ï†ú 'main' Î∏åÎûúÏπòÎ•º Í∏∞Î≥∏ÏúºÎ°ú ÏÇ¨Ïö©Ìï©ÎãàÎã§
    - Í∏∞Ï°¥ 'master' Î∏åÎûúÏπòÏóêÏÑú 'main' Î∏åÎûúÏπòÎ°ú Ï†ÑÌôòÎêòÏóàÏäµÎãàÎã§
    - Netlify Î∞è Î™®Îì† Ïó∞Í≤∞Îêú ÏÑúÎπÑÏä§Îäî 'main' Î∏åÎûúÏπòÎ•º Ï∞∏Ï°∞Ìï¥Ïïº Ìï©ÎãàÎã§
    - This project now uses 'main' branch as default (previously 'master')
-->
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>CRYPTO √ó LIVE üíπ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: #0a0a0a;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            max-width: 900px;
            width: 100%;
            border: 1px solid #1a1a1a;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 40px;
            font-size: 2.5em;
        }

        .exchange-section {
            margin-bottom: 40px;
        }

        h2 {
            color: #aaa;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }

        .price-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .price-card {
            background: #1a1a1a;
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid #333;
            cursor: pointer;
            text-decoration: none;
            display: block;
        }

        .price-card:hover {
            transform: translateY(-5px);
            border-color: #555;
        }

        .symbol {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .price {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .timestamp {
            font-size: 0.85em;
            opacity: 0.8;
        }

        .status {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #333;
            color: #888;
        }

        .links {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #333;
        }

        .links a {
            color: #888;
            text-decoration: none;
            margin: 0 15px;
            font-size: 0.9em;
            transition: color 0.3s ease;
        }

        .links a:hover {
            color: #aaa;
            text-decoration: underline;
        }

        #status-message {
            display: inline-block;
            margin-right: 20px;
            font-weight: bold;
        }

        .connected {
            color: #4caf50;
        }

        .error {
            color: #f44336;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loading {
            animation: pulse 1.5s infinite;
        }
        
        /* YouTube ÎùºÏù¥Î∏å Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes livePulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 0 5px rgba(255, 0, 0, 0);
                transform: scale(1.2);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
                transform: scale(1);
            }
        }
        
        
        /* Î™®Î∞îÏùº Ïä§ÌÉÄÏùº (ÌôîÎ©¥ ÎÑàÎπÑ 768px Ïù¥Ìïò) */
        @media (max-width: 768px) {
            /* Î™®Î∞îÏùºÏóêÏÑú Ï†ÑÏ≤¥ ÌôîÎ©¥ ÌôúÏö© */
            body {
                padding: 0;
                margin: 0;
            }
            
            .container {
                border-radius: 0;
                padding: 0;
                max-width: 100%;
                border: none;
                box-shadow: none;
            }
            
            /* Ïπ¥Îìú ÏÑπÏÖòÎì§ Ïó¨Î∞± Ï†úÍ±∞ */
            .cards {
                padding: 10px 5px;
                gap: 8px;
            }
            
            .card {
                margin: 0;
                padding: 12px;
            }
            
            
            /* Ìó§Îçî Ïπ¥Îìú Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
            .header-card {
                border-radius: 0 !important;
                margin: 0 !important;
                padding: 15px !important;
            }
            
            /* ÌÖåÏù¥Î∏î ÏÑπÏÖò Ìå®Îî© Ï§ÑÏù¥Í∏∞ */
            table {
                margin: 0 5px;
            }
            
            /* ÎßÅÌÅ¨ ÏÑπÏÖò Ìå®Îî© Ï§ÑÏù¥Í∏∞ */
            div[style*="margin-top: 30px"] {
                margin-top: 15px !important;
                padding: 10px 5px !important;
            }
            
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ============================================ -->
        <!-- üìÖ SECTION 1: ÏãúÍ≥Ñ ÏÑπÏÖò -->
        <!-- ÌòÑÏû¨ ÏãúÍ∞Ñ, ÏÇ¨Ïù¥Ìä∏ Ï†úÎ™©, ÎÇ†Ïî® Ï†ïÎ≥¥ ÌëúÏãú -->
        <!-- ============================================ -->
        <div class="header-card" style="
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #333;
            width: 100%;
            box-sizing: border-box;
        ">
            <div style="text-align: center;">
                
                <!-- Ïã§ÏãúÍ∞Ñ ÏãúÍ≥Ñ ÌëúÏãú ÏòÅÏó≠ -->
                <div id="header-update-time" style="margin: 15px 0;"></div>
                
            </div>
        </div>
        <!-- ============================================ -->
        <!-- üìÖ SECTION 1 END: ÏãúÍ≥Ñ ÏÑπÏÖò -->
        <!-- ============================================ -->
        
        <!-- ============================================ -->
        <!-- üí∞ SECTION 2: ÏΩîÏù∏ Í∞ÄÍ≤© Ïπ¥Îìú ÏÑπÏÖò -->
        <!-- TradingView WidgetÏùÑ ÌÜµÌïú Ïã§ÏãúÍ∞Ñ Í∞ÄÍ≤© ÌëúÏãú -->
        <!-- BTC, ETH, SOL, XRP Îì± Ï£ºÏöî ÏΩîÏù∏ Í∞ÄÍ≤© -->
        <!-- ============================================ -->
        <div class="exchange-section">
            <!-- ÏÑπÏÖò Ìó§Îçî (Ï∞®Ìä∏ ÌéòÏù¥ÏßÄ ÎßÅÌÅ¨ Ìè¨Ìï®) -->
            <h2><a href="dual-chart.html" style="color: inherit; text-decoration: none; transition: all 0.3s;" onmouseover="this.style.color='#f7931a'" onmouseout="this.style.color='inherit'">üìà Crypto Market Overview</a></h2>
            
            
            <!-- Custom Crypto Price Display -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 0; margin-bottom: 20px;">
                <!-- BTC Price Card -->
                <a href="chart.html?symbol=BTCUSDT" style="text-decoration: none; display: block;">
                <div style="background: #0d0d0d; border-radius: 10px; padding: 8px; border: 1px solid #222; transition: all 0.3s ease; cursor: pointer;"
                     onmouseover="this.style.transform='translateY(-2px)'; this.style.borderColor='#444';" 
                     onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='#222';">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: #f7931a; font-size: 1.2em; font-weight: bold;">‚Çø BTC</span>
                        <span style="color: #666; font-size: 0.9em;">USDT</span>
                    </div>
                    <div id="btc-price-custom" style="font-size: 2.5em; font-weight: bold; color: #f7931a; margin-bottom: 5px; text-align: right;">Loading...</div>
                    <div id="btc-change-custom" style="font-size: 1em; color: #4caf50; text-align: right;">-</div>
                </div>
                </a>
                
                <!-- ETH Price Card -->
                <a href="chart.html?symbol=ETHUSDT" style="text-decoration: none; display: block;">
                <div style="background: #0d0d0d; border-radius: 10px; padding: 8px; border: 1px solid #222; transition: all 0.3s ease; cursor: pointer;"
                     onmouseover="this.style.transform='translateY(-2px)'; this.style.borderColor='#444';" 
                     onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='#222';">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: #9a8ff8; font-size: 1.2em; font-weight: bold;">Œû ETH</span>
                        <span style="color: #666; font-size: 0.9em;">USDT</span>
                    </div>
                    <div id="eth-price-custom" style="font-size: 2.5em; font-weight: bold; color: #9a8ff8; margin-bottom: 5px; text-align: right;">Loading...</div>
                    <div id="eth-change-custom" style="font-size: 1em; color: #4caf50; text-align: right;">-</div>
                </div>
                </a>
                
                <!-- SOL Price Card -->
                <a href="chart.html?symbol=SOLUSDT" style="text-decoration: none; display: block;">
                <div style="background: #0d0d0d; border-radius: 10px; padding: 8px; border: 1px solid #222; transition: all 0.3s ease; cursor: pointer;"
                     onmouseover="this.style.transform='translateY(-2px)'; this.style.borderColor='#444';" 
                     onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='#222';">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: #00FFA3; font-size: 1.2em; font-weight: bold;">‚óé SOL</span>
                        <span style="color: #666; font-size: 0.9em;">USDT</span>
                    </div>
                    <div id="sol-price-custom" style="font-size: 2.5em; font-weight: bold; color: #00FFA3; margin-bottom: 5px; text-align: right;">Loading...</div>
                    <div id="sol-change-custom" style="font-size: 1em; color: #4caf50; text-align: right;">-</div>
                </div>
                </a>
                
                <!-- NASDAQ (NDX) Price Card -->
                <div style="background: #0d0d0d; border-radius: 10px; padding: 8px; border: 1px solid #222;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: #4facfe; font-size: 1.2em; font-weight: bold;">üìä NDX</span>
                        <span style="color: #666; font-size: 0.9em;">NASDAQ-100</span>
                    </div>
                    <div id="nasdaq-price" style="font-size: 2.5em; font-weight: bold; color: #fff; margin-bottom: 5px; text-align: right;">Loading...</div>
                    <div style="font-size: 1em; text-align: right;">
                        <span id="nasdaq-change" style="color: #4caf50;">-</span>
                        <span style="color: #666; margin: 0 5px;">|</span>
                        <span id="nasdaq-percent" style="color: #4caf50;">-</span>
                    </div>
                </div>
            </div>
        </div>

        
        <!-- Ïã§ÏãúÍ∞Ñ Ï±ÑÌåÖ ÏÑπÏÖò -->
        <div style="margin-top: 30px; margin-bottom: 30px; padding: 20px; background: #0a0a0a; border-radius: 15px; border: 1px solid #333;">
            <h2 style="color: #aaa; margin-bottom: 20px; text-align: center;">üí¨ Ïã§ÏãúÍ∞Ñ Ï±ÑÌåÖ</h2>
            <iframe src="chat-popup.html" style="
                width: 100%;
                height: 500px;
                border: none;
                border-radius: 10px;
                background: #000;
            "></iframe>
        </div>
        <!-- ============================================ -->
        <!-- üí∞ SECTION 2 END: ÏΩîÏù∏ Í∞ÄÍ≤© Ïπ¥Îìú ÏÑπÏÖò -->
        <!-- ============================================ -->
        
        <!-- ============================================ -->
        <!-- üóÑÔ∏è SECTION 3: Supabase DB Ï∂îÏ∂ú ÏÑπÏÖò -->
        <!-- Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ÏóêÏÑú ÎßÅÌÅ¨ Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏ÏôÄÏÑú ÌëúÏãú -->
        <!-- GPT Links, YouTube Live, Favorite Sites Îì± -->
        <!-- ============================================ -->
        
        
        <!-- 3-1. GPT ÎßÅÌÅ¨ ÏÑúÎ∏åÏÑπÏÖò -->
        <div class="gpt-section" style="margin-top: 20px; padding-bottom: 20px;">
            <h2 style="color: #aaa; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #333;">
                ü§ñ GPT Links
            </h2>
            <div id="gpt-links" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <!-- GPT ÎßÅÌÅ¨Îì§Ïù¥ SupabaseÏóêÏÑú ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
            </div>
        </div>
        
        <!-- 3-2. YouTube Live ÏÑúÎ∏åÏÑπÏÖò -->
        <div class="youtube-section" style="margin-top: 20px; padding-bottom: 20px;">
            <h2 style="color: #aaa; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #333;">
                üì∫ YouTube Live
            </h2>
            <div id="youtube-links" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <!-- YouTube ÎßÅÌÅ¨Îì§Ïù¥ SupabaseÏóêÏÑú ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
                <!-- ÎùºÏù¥Î∏å ÏÉÅÌÉú Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ìè¨Ìï® -->
            </div>
        </div>
        
        <!-- 3-3. Favorite Sites ÏÑúÎ∏åÏÑπÏÖò -->
        <div class="favorite-section" style="margin-top: 20px; padding-bottom: 20px;">
            <h2 style="color: #aaa; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #333;">
                ‚≠ê Favorite Sites
            </h2>
            <div id="favorite-links" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <!-- Favorite ÎßÅÌÅ¨Îì§Ïù¥ SupabaseÏóêÏÑú ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
            </div>
        </div>
        
        <!-- Fun YouTube ÏÑπÏÖò -->
        <div class="fun-youtube-section" style="margin-top: 20px; padding-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #333;">
                <h2 style="color: #aaa; margin: 0; font-weight: 400; font-size: 1.5rem;">
                    üéÆ Fun YouTube
                </h2>
                <div style="display: flex; gap: 10px;">
                    <button onclick="toggleFunYoutubeView('list')" class="fun-youtube-view-btn" data-view="list" style="
                        padding: 6px 12px;
                        background: #fff;
                        color: #000;
                        border: 1px solid #444;
                        cursor: pointer;
                        font-size: 12px;
                        transition: all 0.2s ease;
                        border-radius: 4px;
                    ">List</button>
                    <button onclick="toggleFunYoutubeView('grid')" class="fun-youtube-view-btn" data-view="grid" style="
                        padding: 6px 12px;
                        background: transparent;
                        color: #999;
                        border: 1px solid #444;
                        cursor: pointer;
                        font-size: 12px;
                        transition: all 0.2s ease;
                        border-radius: 4px;
                    ">Grid</button>
                </div>
            </div>
            <div id="fun-youtube-links-list" style="display: flex; flex-direction: column; gap: 1px; background: transparent;">
                <!-- List view -->
            </div>
            <div id="fun-youtube-links-grid" style="display: none; grid-template-columns: repeat(3, 1fr); gap: 20px; background: transparent;">
                <!-- Grid view -->
            </div>
        </div>
        
        <!-- 3-5. Ïª§Ïä§ÌÖÄ Ïπ¥ÌÖåÍ≥†Î¶¨ ÎèôÏ†Å ÏÑπÏÖò -->
        <!-- localStorageÏóêÏÑú customCategoriesÎ•º ÏùΩÏñ¥ÏôÄÏÑú ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ± -->
        <div id="custom-category-sections"></div>
        
        <!-- ============================================ -->
        <!-- üóÑÔ∏è SECTION 3 END: Supabase DB Ï∂îÏ∂ú ÏÑπÏÖò -->
        <!-- ============================================ -->
        
        <!-- BTC 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù ÏÑπÏÖò -->
        <div class="btc-history-section" style="margin-top: 20px; padding: 20px; background: #0a0a0a; border-radius: 15px; border: 1px solid #333;">
            <h3 style="color: #aaa; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                <span><span style="color: #f7931a;">‚Çø</span> BTC ÏµúÍ∑º 10Ïùº Í∏∞Î°ù</span>
                <button onclick="refreshPriceHistory()" style="padding: 5px 10px; background: #222; border: 1px solid #444; border-radius: 5px; color: #aaa; cursor: pointer; font-size: 12px;">üîÑ ÏÉàÎ°úÍ≥†Ïπ®</button>
            </h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead>
                        <tr style="border-bottom: 2px solid #333;">
                            <th style="padding: 10px; text-align: left; color: #888;">ÎÇ†Ïßú</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÍ≥†Í∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÏ†ÄÍ∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">Ï¢ÖÍ∞Ä</th>
                        </tr>
                    </thead>
                    <tbody id="btc-history-tbody">
                        <tr>
                            <td colspan="4" style="padding: 20px; text-align: center; color: #666;">Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- ETH 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù ÏÑπÏÖò -->
        <div class="eth-history-section" style="margin-top: 20px; padding: 20px; background: #0a0a0a; border-radius: 15px; border: 1px solid #333;">
            <h3 style="color: #aaa; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                <span><span style="color: #627eea;">Œû</span> ETH ÏµúÍ∑º 10Ïùº Í∏∞Î°ù</span>
            </h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead>
                        <tr style="border-bottom: 2px solid #333;">
                            <th style="padding: 10px; text-align: left; color: #888;">ÎÇ†Ïßú</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÍ≥†Í∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÏ†ÄÍ∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">Ï¢ÖÍ∞Ä</th>
                        </tr>
                    </thead>
                    <tbody id="eth-history-tbody">
                        <tr>
                            <td colspan="4" style="padding: 20px; text-align: center; color: #666;">Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- SOL 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù ÏÑπÏÖò -->
        <div class="sol-history-section" style="margin-top: 20px; padding: 20px; background: #0a0a0a; border-radius: 15px; border: 1px solid #333;">
            <h3 style="color: #aaa; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                <span><span style="color: #00FFA3;">‚óé</span> SOL ÏµúÍ∑º 10Ïùº Í∏∞Î°ù</span>
            </h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead>
                        <tr style="border-bottom: 2px solid #333;">
                            <th style="padding: 10px; text-align: left; color: #888;">ÎÇ†Ïßú</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÍ≥†Í∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">ÏµúÏ†ÄÍ∞Ä</th>
                            <th style="padding: 10px; text-align: right; color: #aaa;">Ï¢ÖÍ∞Ä</th>
                        </tr>
                    </thead>
                    <tbody id="sol-history-tbody">
                        <tr>
                            <td colspan="4" style="padding: 20px; text-align: center; color: #666;">Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- üåç SECTION 5: World Clock -->
        <!-- ============================================ -->
        <div class="exchange-section" style="margin-top: 40px;">
            <h2 style="text-align: center; color: #aaa; margin-bottom: 20px;">üåç World Clock</h2>
            <div id="clock-container" style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 15px;
                max-width: 800px;
                margin: 0 auto;
            ">
                <!-- Clocks will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="links-module.js"></script>
    <script src="supabase-config.js"></script>
    <script>
        // Clock toggle function
        function toggleClockSection() {
            const clockSection = document.getElementById('clock-section');
            const toggleIcon = document.getElementById('clock-toggle-icon');
            
            if (clockSection.style.display === 'none') {
                clockSection.style.display = 'block';
                toggleIcon.textContent = '‚ñ≤';
            } else {
                clockSection.style.display = 'none';
                toggleIcon.textContent = '‚ñº';
            }
        }

        let binanceBtcWs = null;
        let binanceEthWs = null;
        let binanceXrpWs = null;
        let binanceSolWs = null;
        let binanceAvaxWs = null;

        function formatPrice(price) {
            // null, undefined, Îπà Î¨∏ÏûêÏó¥ Ï≤òÎ¶¨
            if (price === null || price === undefined || price === '') {
                return '-';
            }
            
            const num = parseFloat(price);
            
            // NaN Ï≤¥ÌÅ¨
            if (isNaN(num)) {
                return '-';
            }
            
            const parts = num.toFixed(2).split('.');
            const integerPart = parseInt(parts[0]).toLocaleString('en-US');
            return `<span style="color: #000;">${integerPart}</span><span style="color: #666; font-size: 0.7em;">.${parts[1]}</span>`;
        }


        function updateLastUpdate() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            // ÏòÅÏñ¥Ïãù ÏÑúÏàò ÎÇ†Ïßú ÌòïÏãù (Ïòà: 18th September)
            const englishMonths = ['January', 'February', 'March', 'April', 'May', 'June', 
                                  'July', 'August', 'September', 'October', 'November', 'December'];
            
            function getOrdinalSuffix(day) {
                if (day >= 11 && day <= 13) return 'th';
                const lastDigit = day % 10;
                switch (lastDigit) {
                    case 1: return 'st';
                    case 2: return 'nd';
                    case 3: return 'rd';
                    default: return 'th';
                }
            }
            
            const day = now.getDate();
            const month = englishMonths[now.getMonth()];
            const dateString = `${day}${getOrdinalSuffix(day)} ${month}`;
            
            // Header update time with multiple timezones
            const headerTimeElement = document.getElementById('header-update-time');
            if (headerTimeElement) {
                // Calculate different timezones (East to West order)
                const korTime = new Date(now.toLocaleString("en-US", {timeZone: "Asia/Seoul"}));
                const sydTime = new Date(now.toLocaleString("en-US", {timeZone: "Australia/Sydney"}));
                const dubaiTime = new Date(now.toLocaleString("en-US", {timeZone: "Asia/Dubai"}));
                const euTime = new Date(now.toLocaleString("en-US", {timeZone: "Europe/London"}));
                const usTime = new Date(now.toLocaleString("en-US", {timeZone: "America/New_York"}));
                
                // Format times (24-hour format)
                const formatTime = (date) => {
                    const h = date.getHours().toString().padStart(2, '0');
                    const m = date.getMinutes().toString().padStart(2, '0');
                    const s = date.getSeconds().toString().padStart(2, '0');
                    return {hours: h, minutes: m, seconds: s};
                };
                
                const kor = formatTime(korTime);
                const syd = formatTime(sydTime);
                const dubai = formatTime(dubaiTime);
                const eu = formatTime(euTime);
                const us = formatTime(usTime);
                
                // US Market hours (9:30 AM - 4:00 PM ET)
                const marketHour = usTime.getHours();
                const marketMin = usTime.getMinutes();
                let marketStatus = '';
                
                if ((marketHour === 9 && marketMin >= 30) || (marketHour > 9 && marketHour < 16)) {
                    marketStatus = '<span style="color: #4caf50;">üü¢ Market Open</span>';
                } else if (marketHour < 9 || (marketHour === 9 && marketMin < 30)) {
                    const openTime = new Date(usTime);
                    openTime.setHours(9, 30, 0);
                    const diff = Math.floor((openTime - usTime) / 60000);
                    if (diff > 0) {
                        marketStatus = `<span style="color: #ff9800;">‚è∞ Opens in ${Math.floor(diff/60)}h ${diff%60}m</span>`;
                    }
                } else {
                    marketStatus = '<span style="color: #f44336;">üî¥ Market Closed</span>';
                }
                
                headerTimeElement.innerHTML = `
                    <div style="text-align: center;">
                        <div style="
                            font-size: 1.2em;
                            font-weight: bold;
                            margin-bottom: 15px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            gap: 20px;
                            cursor: pointer;
                            user-select: none;
                        " onclick="toggleClockSection()">
                            <span style="
                                background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #dda0dd);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                background-clip: text;
                            ">${dateString}</span>
                            ${marketStatus}
                        </div>
                        
                        <!-- Clock section removed - moved to bottom -->
                        <div id="clock-section" style="display: none;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap: 8px; margin: 0 auto 10px;">
                            <!-- KOR: UTC+9 -->
                            <div style="
                                background: #0a0a0a;
                                color: white;
                                padding: 15px 10px;
                                border-radius: 10px;
                                text-align: center;
                                border: 1px solid #333;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="window.open('fullscreen-clock.html?tz=Asia/Seoul', '_blank')" onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'" onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">
                                    <img src="https://flagcdn.com/24x18/kr.png" alt="South Korea" style="width: 24px; height: 18px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                                    <span style="color: #888; font-size: 0.9em; font-weight: bold;">KOR</span>
                                </div>
                                <div style="font-size: 1.4em; font-weight: bold; line-height: 1;">
                                    ${kor.hours}:${kor.minutes}<span style="font-size: 0.6em; color: #666;">:${kor.seconds}</span>
                                </div>
                            </div>
                            
                            <!-- SYD: UTC+10/+11 -->
                            <div style="
                                background: #0a0a0a;
                                color: white;
                                padding: 15px 10px;
                                border-radius: 10px;
                                text-align: center;
                                border: 1px solid #333;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="window.open('fullscreen-clock.html?tz=Australia/Sydney', '_blank')" onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'" onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">
                                    <img src="https://flagcdn.com/24x18/au.png" alt="Australia" style="width: 24px; height: 18px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                                    <span style="color: #888; font-size: 0.9em; font-weight: bold;">SYD</span>
                                </div>
                                <div style="font-size: 1.4em; font-weight: bold; line-height: 1;">
                                    ${syd.hours}:${syd.minutes}<span style="font-size: 0.6em; color: #666;">:${syd.seconds}</span>
                                </div>
                            </div>

                            <!-- DXB: UTC+4 -->
                            <div style="
                                background: #0a0a0a;
                                color: white;
                                padding: 15px 10px;
                                border-radius: 10px;
                                text-align: center;
                                border: 1px solid #333;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="window.open('fullscreen-clock.html?tz=Asia/Dubai', '_blank')" onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'" onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">
                                    <img src="https://flagcdn.com/24x18/ae.png" alt="UAE" style="width: 24px; height: 18px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                                    <span style="color: #888; font-size: 0.9em; font-weight: bold;">DXB</span>
                                </div>
                                <div style="font-size: 1.4em; font-weight: bold; line-height: 1;">
                                    ${dubai.hours}:${dubai.minutes}<span style="font-size: 0.6em; color: #666;">:${dubai.seconds}</span>
                                </div>
                            </div>
                            
                            <!-- LON: UTC+0/+1 -->
                            <div style="
                                background: #0a0a0a;
                                color: white;
                                padding: 15px 10px;
                                border-radius: 10px;
                                text-align: center;
                                border: 1px solid #333;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="window.open('fullscreen-clock.html?tz=Europe/London', '_blank')" onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'" onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">
                                    <img src="https://flagcdn.com/24x18/gb.png" alt="United Kingdom" style="width: 24px; height: 18px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                                    <span style="color: #888; font-size: 0.9em; font-weight: bold;">LON</span>
                                </div>
                                <div style="font-size: 1.4em; font-weight: bold; line-height: 1;">
                                    ${eu.hours}:${eu.minutes}<span style="font-size: 0.6em; color: #666;">:${eu.seconds}</span>
                                </div>
                            </div>
                            
                            <!-- NYC: UTC-5/-4 -->
                            <div style="
                                background: #0a0a0a;
                                color: white;
                                padding: 15px 10px;
                                border-radius: 10px;
                                text-align: center;
                                border: 1px solid #333;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="window.open('fullscreen-clock.html?tz=America/New_York', '_blank')" onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'" onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">
                                    <img src="https://flagcdn.com/24x18/us.png" alt="United States" style="width: 24px; height: 18px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                                    <span style="color: #888; font-size: 0.9em; font-weight: bold;">NYC</span>
                                </div>
                                <div style="font-size: 1.4em; font-weight: bold; line-height: 1;">
                                    ${us.hours}:${us.minutes}<span style="font-size: 0.6em; color: #666;">:${us.seconds}</span>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                `;
            }
        }

        // Binance WebSocket for custom price cards
        function connectBinance() {
            const symbols = ['btcusdt', 'ethusdt', 'solusdt'];
            
            symbols.forEach(symbol => {
                const ws = new WebSocket(`wss://stream.binance.com/ws/${symbol}@ticker`);
                

                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    if (data.c) {
                        const price = data.c;
                        const high = data.h;  // 24ÏãúÍ∞Ñ ÏµúÍ≥†Í∞Ä
                        const low = data.l;   // 24ÏãúÍ∞Ñ ÏµúÏ†ÄÍ∞Ä
                        
                        // Ïã¨Î≥º Ïù¥Î¶Ñ Ï∂îÏ∂ú (btc, eth, xrp Îì±)
                        const coinName = symbol.replace('usdt', '');
                        const fullSymbol = symbol.toUpperCase() + 'USDT';
                        
                        // Í∞ÄÍ≤© Í∏∞Î°ù ÏóÖÎç∞Ïù¥Ìä∏ (BTC, ETH, SOLÎßå)
                        if (fullSymbol === 'BTCUSDT' || fullSymbol === 'ETHUSDT' || fullSymbol === 'SOLUSDT') {
                            if (currentPrices[fullSymbol]) {
                                currentPrices[fullSymbol].current = parseFloat(price);
                                currentPrices[fullSymbol].high = Math.max(currentPrices[fullSymbol].high || 0, parseFloat(high));
                                currentPrices[fullSymbol].low = Math.min(currentPrices[fullSymbol].low || 999999999, parseFloat(low));
                            }
                        }
                        
                        // Í∞ÄÍ≤© ÏóÖÎç∞Ïù¥Ìä∏
                        const priceElement = document.getElementById(`binance-${coinName}`);
                        if (priceElement) {
                            priceElement.innerHTML = formatPrice(price);
                            priceElement.classList.remove('loading');
                        }
                        
                        // Custom price cards ÏóÖÎç∞Ïù¥Ìä∏
                        const customPriceElement = document.getElementById(`${coinName}-price-custom`);
                        const customChangeElement = document.getElementById(`${coinName}-change-custom`);
                        
                        if (customPriceElement) {
                            const priceNum = parseFloat(price);
                            const change = parseFloat(data.P || 0); // 24h Î≥ÄÌôîÏú® %
                            const changeAmount = parseFloat(data.p || 0); // 24h Î≥ÄÌôîÎüâ
                            
                            // Îã¨Îü¨ Í∏∞Ìò∏Î•º Í≤ÄÏ†ïÏÉâÏúºÎ°ú, Í∞ÄÍ≤©ÏùÄ Î∏åÎûúÎìú ÏÉâÏÉÅÏúºÎ°ú
                            const parts = priceNum.toFixed(2).split('.');
                            const integerPart = parseInt(parts[0]).toLocaleString('en-US');
                            customPriceElement.innerHTML = `<span style="color: #000;">$</span>${integerPart}<span style="font-size: 0.7em;">.${parts[1]}</span>`;
                            
                            // Í∞ÄÍ≤© ÏÉâÏÉÅÏùÄ Î∏åÎûúÎìú Ïª¨Îü¨ Ïú†ÏßÄ (Î≥ÄÍ≤ΩÌïòÏßÄ ÏïäÏùå)
                            
                            // Î≥ÄÌôîÎüâ ÌëúÏãú
                            if (customChangeElement) {
                                const sign = change >= 0 ? '+' : '';
                                customChangeElement.textContent = `${sign}${changeAmount.toFixed(2)} (${sign}${change.toFixed(2)}%)`;
                                customChangeElement.style.color = change >= 0 ? '#4caf50' : '#f44336';
                            }
                        }
                        
                        // ÏµúÍ≥†Í∞Ä/ÏµúÏ†ÄÍ∞Ä ÏóÖÎç∞Ïù¥Ìä∏
                        const highElement = document.getElementById(`${coinName}-high`);
                        const lowElement = document.getElementById(`${coinName}-low`);
                        if (highElement && high) {
                            highElement.innerHTML = formatPrice(high);
                        }
                        if (lowElement && low) {
                            lowElement.innerHTML = formatPrice(low);
                        }
                        
                        // Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞Îäî savePriceHistory Ìï®ÏàòÏóêÏÑú 5Î∂ÑÎßàÎã§ ÏûêÎèô Ï†ÄÏû•Îê®
                        
                        updateLastUpdate();
                    }
                };

                ws.onerror = function(error) {
                    console.error('Binance WebSocket error:', error);
                };

                if (symbol === 'btcusdt') {
                    binanceBtcWs = ws;
                } else if (symbol === 'ethusdt') {
                    binanceEthWs = ws;
                } else if (symbol === 'xrpusdt') {
                    binanceXrpWs = ws;
                } else if (symbol === 'solusdt') {
                    binanceSolWs = ws;
                } else if (symbol === 'avaxusdt') {
                    binanceAvaxWs = ws;
                }
            });
        }

        // Ï¥àÍ∏∞ Î°úÎî© ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
        document.querySelectorAll('.price').forEach(el => {
            el.classList.add('loading');
        });

        // WebSocket Ïó∞Í≤∞ ÏãúÏûë - Re-enabled for custom price cards
        connectBinance();
        
        // Fun YouTube view toggle function
        function toggleFunYoutubeView(view) {
            window.funYoutubeViewMode = view;
            const buttons = document.querySelectorAll('.fun-youtube-view-btn');
            buttons.forEach(btn => {
                btn.style.background = btn.getAttribute('data-view') === view ? '#fff' : 'transparent';
                btn.style.color = btn.getAttribute('data-view') === view ? '#000' : '#999';
            });

            // Save the view mode preference
            const funSettings = JSON.parse(localStorage.getItem('funYoutubeSettings') || '{}');
            funSettings.viewMode = view;
            localStorage.setItem('funYoutubeSettings', JSON.stringify(funSettings));

            loadLinksFromSupabase(); // Reload to apply new view
        }

        // Extract video ID from YouTube URL
        function getVideoIdFromUrl(url) {
            if (!url) return null;
            const regex = /(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // YouTube ÎπÑÎîîÏò§ Ï†ïÎ≥¥ Ï∫êÏãú
        const youtubeVideoCache = {};

        // YouTube ÎπÑÎîîÏò§ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞ (noembed ÏÑúÎπÑÏä§ ÏÇ¨Ïö©)
        async function getYouTubeVideoInfo(url) {
            // Ï∫êÏãú ÌôïÏù∏
            if (youtubeVideoCache[url]) {
                return youtubeVideoCache[url];
            }

            try {
                const response = await fetch(`https://noembed.com/embed?url=${encodeURIComponent(url)}`);
                const data = await response.json();

                if (data && data.title) {
                    const videoInfo = {
                        title: data.title,
                        author: data.author_name || 'Unknown',
                        thumbnail: data.thumbnail_url || `https://img.youtube.com/vi/${getVideoIdFromUrl(url)}/maxresdefault.jpg`
                    };

                    // Ï∫êÏãúÏóê Ï†ÄÏû•
                    youtubeVideoCache[url] = videoInfo;
                    return videoInfo;
                }
            } catch (error) {
                console.error('YouTube Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:', error);
            }

            // Ïã§Ìå® Ïãú Í∏∞Î≥∏Í∞í Î∞òÌôò
            const videoId = getVideoIdFromUrl(url);
            return {
                title: 'ÎèôÏòÅÏÉÅ',
                author: '',
                thumbnail: videoId ? `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg` : ''
            };
        }

        // Ï†ÄÏû•Îêú Ïπ¥Îìú Ïä§ÌÉÄÏùº Í∞ÄÏ†∏Ïò§Í∏∞ (ÏïàÏ†ÑÌïú Î≤ÑÏ†Ñ - NaN Î∞©ÏßÄ)
        function getCardStyles(category) {
            // Ìï≠ÏÉÅ Í∏∞Î≥∏ Ïä§ÌÉÄÏùºÎßå ÏÇ¨Ïö© (localStorage Î¨¥Ïãú)
            const defaultStyles = {
                gpt: {
                    fontSize: 16, fontWeight: '500', bgColor: '#1a1a1a', textColor: '#ffffff',
                    borderColor: '#333333', borderWidth: 1, borderRadius: 10, padding: 15,
                    hoverBg: '#2a2a2a'
                },
                youtube: {
                    fontSize: 17, fontWeight: '600', bgColor: '#1a1a1a', textColor: '#ffffff',
                    borderColor: '#333333', borderWidth: 1, borderRadius: 10, padding: 15,
                    hoverBg: '#2a2a2a'
                },
                favorite: {
                    fontSize: 16, fontWeight: '500', bgColor: '#1a1a1a', textColor: '#ffffff',
                    borderColor: '#333333', borderWidth: 1, borderRadius: 10, padding: 15,
                    hoverBg: '#2a2a2a'
                }
            };
            
            return defaultStyles[category] || defaultStyles.gpt;
        }

        // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Ìï®Ïàò (XSS Î∞©ÏßÄ)
        function escapeHtml(unsafe) {
            if (!unsafe) return '';
            return String(unsafe)
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // ÏïàÏ†ÑÌïú ÏóêÎü¨ Î©îÏãúÏßÄ ÌëúÏãú Ìï®Ïàò
        function showSafeErrorMessage() {
            const containers = ['gpt-links', 'youtube-links', 'favorite-links', 'fun-youtube-links-list'];
            
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container && container.innerHTML.trim() === '') {
                    const errorDiv = document.createElement('div');
                    errorDiv.style.cssText = `
                        color: #888;
                        text-align: center;
                        padding: 20px;
                        background: #1a1a1a;
                        border-radius: 10px;
                        border: 1px solid #333;
                    `;
                    errorDiv.textContent = 'ÎßÅÌÅ¨Î•º Î∂àÎü¨Ïò§Îäî Ï§ëÏûÖÎãàÎã§...';
                    container.appendChild(errorDiv);
                }
            });
        }

        // Ï±ÑÌåÖ ÌåùÏóÖ Ïó¥Í∏∞ Ìï®Ïàò
        function openChatPopup() {
            // ÌåùÏóÖ Ï∞Ω ÏÑ§Ï†ï
            const width = 400;
            const height = 600;
            const left = window.screen.width - width - 50;
            const top = 100;
            
            const features = `
                width=${width},
                height=${height},
                left=${left},
                top=${top},
                toolbar=no,
                menubar=no,
                scrollbars=no,
                resizable=yes,
                status=no
            `.replace(/\s+/g, '');
            
            // ÌåùÏóÖ Ïó¥Í∏∞
            const chatWindow = window.open('chat-popup.html', 'ChatWindow', features);
            
            // Ìè¨Ïª§Ïä§ Ï£ºÍ∏∞
            if (chatWindow) {
                chatWindow.focus();
            }
        }

        // SupabaseÏóêÏÑú ÎßÅÌÅ¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú (ÏïàÏ†ÑÌïú Î≤ÑÏ†Ñ)
        async function loadLinksFromSupabase() {
            console.log('üóÑÔ∏è === SECTION 3: Supabase DB Ï∂îÏ∂ú ÏãúÏûë ===');
            
            try {
                // Supabase ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä Î°úÎìúÎê† ÎïåÍπåÏßÄ ÎåÄÍ∏∞
                let attempts = 0;
                while (!window.supabase && attempts < 20) {
                    console.log(`Waiting for Supabase library... attempt ${attempts + 1}/20`);
                    await new Promise(resolve => setTimeout(resolve, 200));
                    attempts++;
                }
                
                if (!window.supabase) {
                    console.error('Supabase library failed to load after 4 seconds');
                    // Í∏∞Î≥∏ ÏïàÏ†Ñ Î©îÏãúÏßÄ ÌëúÏãú
                    showSafeErrorMessage();
                    return;
                }
                
                console.log('‚úÖ Supabase ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú ÏôÑÎ£å');
            } catch (error) {
                console.error('Ï¥àÍ∏∞ Supabase Ï≤¥ÌÅ¨ Ïò§Î•ò:', error);
                showSafeErrorMessage();
                return;
            }

            // Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî
            if (!window.supabaseClient) {
                try {
                    const SUPABASE_URL = 'https://ddfnxbkiewolgweivomv.supabase.co';
                    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZm54YmtpZXdvbGd3ZWl2b212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MzI3NzYsImV4cCI6MjA2NzIwODc3Nn0.YCS2UH6YWarPX3C2ryFUUQnFA-3er_ZQomf_mccjmD8';
                    window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                    console.log('‚úì Supabase client initialized successfully');
                } catch (error) {
                    console.error('Failed to initialize Supabase:', error);
                    return;
                }
            }
            
            const supabase = window.supabaseClient;

            try {
                const { data: links, error } = await supabase
                    .from('links')
                    .select('*')
                    .order('position', { ascending: true });
                
                if (error) {
                    console.error('Supabase error:', error);
                    console.error('Error details:', error.message, error.code);
                    throw error;
                }
                
                console.log('Links loaded:', links);
                console.log('Total links count:', links ? links.length : 0);
                
                // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥ÑÎ°ú ÎßÅÌÅ¨ Î∂ÑÎ•ò
                const gptLinks = links ? links.filter(link => link.category === 'gpt') : [];
                const youtubeLinks = links ? links.filter(link => link.category === 'youtube') : [];
                const favoriteLinks = links ? links.filter(link => link.category === 'favorite') : [];
                const funYoutubeLinks = links ? links.filter(link => link.category === 'fun-youtube') : [];
                
                // Ïª§Ïä§ÌÖÄ Ïπ¥ÌÖåÍ≥†Î¶¨ Ï≤òÎ¶¨
                const customCategories = JSON.parse(localStorage.getItem('customCategories') || '[]');
                const customCategoryLinks = {};
                customCategories.forEach(cat => {
                    customCategoryLinks[cat.id] = links ? links.filter(link => link.category === cat.id) : [];
                });
                
                console.log('GPT links:', gptLinks.length);
                console.log('YouTube links:', youtubeLinks.length);
                console.log('Favorite links:', favoriteLinks.length);
                console.log('Fun YouTube links:', funYoutubeLinks.length);
                console.log('Custom categories:', customCategories);
                
                // Ï¥àÍ∞ÑÎã® GPT ÎßÅÌÅ¨ Î†åÎçîÎßÅ
                const gptContainer = document.getElementById('gpt-links');
                if (gptContainer) {
                    console.log('ü§ñ GPT ÎßÅÌÅ¨ Î†åÎçîÎßÅ ÏãúÏûë, Í∞úÏàò:', gptLinks.length);
                    gptContainer.innerHTML = ''; // Í∏∞Ï°¥ ÎÇ¥Ïö© Ï†úÍ±∞
                    
                    if (gptLinks && gptLinks.length > 0) {
                        gptLinks.forEach((link, index) => {
                            console.log(`GPT ÎßÅÌÅ¨ ${index + 1}:`, link);
                            
                            // Ï¥àÍ∞ÑÎã® ÎßÅÌÅ¨ ÏöîÏÜå ÏÉùÏÑ±
                            const linkEl = document.createElement('a');
                            linkEl.href = link.url || '#';
                            linkEl.target = '_blank';
                            linkEl.textContent = link.name || `GPT Link ${index + 1}`;
                            
                            // Ï¥àÍ∞ÑÎã® Ïä§ÌÉÄÏùº
                            linkEl.style.cssText = `
                                display: block;
                                background: #1a1a1a;
                                color: #ffffff;
                                padding: 15px;
                                margin: 5px 0;
                                border-radius: 8px;
                                text-decoration: none;
                                border: 1px solid #333;
                                text-align: center;
                                transition: all 0.3s ease;
                            `;
                            
                            // Ìò∏Î≤Ñ Ìö®Í≥º
                            linkEl.onmouseover = () => {
                                linkEl.style.background = '#2a2a2a';
                                linkEl.style.borderColor = '#555';
                            };
                            linkEl.onmouseout = () => {
                                linkEl.style.background = '#1a1a1a';
                                linkEl.style.borderColor = '#333';
                            };
                            
                            gptContainer.appendChild(linkEl);
                        });
                        
                        console.log('‚úÖ GPT ÎßÅÌÅ¨ Î†åÎçîÎßÅ ÏôÑÎ£å');
                    } else {
                        gptContainer.innerHTML = '<div style="color: #666; text-align: center; padding: 20px;">GPT ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
                        console.log('‚ö†Ô∏è GPT ÎßÅÌÅ¨ ÏóÜÏùå');
                    }
                }
                
                // YouTube ÎßÅÌÅ¨ Î†åÎçîÎßÅ (original card style)
                const youtubeContainer = document.getElementById('youtube-links');
                if (youtubeContainer) {
                    youtubeContainer.innerHTML = ''; // Í∏∞Ï°¥ ÎÇ¥Ïö© Ï†úÍ±∞
                    
                    if (youtubeLinks.length > 0) {
                        const youtubeStyles = getCardStyles('youtube');
                        
                        youtubeLinks.forEach(link => {
                            const linkElement = document.createElement('a');
                            linkElement.href = link.url || '#';
                            linkElement.target = '_blank';
                            
                            // Ïä§ÌÉÄÏùº Ï†ÅÏö© (Í∞úÎ≥Ñ ÏÜçÏÑ±ÏúºÎ°ú ÏïàÏ†ÑÌïòÍ≤å)
                            linkElement.style.background = youtubeStyles.bgColor || '#1a1a1a';
                            linkElement.style.color = youtubeStyles.textColor || '#ffffff';
                            linkElement.style.padding = (youtubeStyles.padding || 15) + 'px';
                            linkElement.style.borderRadius = (youtubeStyles.borderRadius || 10) + 'px';
                            linkElement.style.textAlign = 'center';
                            linkElement.style.border = `${youtubeStyles.borderWidth || 1}px solid ${youtubeStyles.borderColor || '#333333'}`;
                            linkElement.style.textDecoration = 'none';
                            linkElement.style.transition = 'transform 0.3s ease';
                            linkElement.style.display = 'block';
                            linkElement.style.position = 'relative';
                            linkElement.style.fontWeight = youtubeStyles.fontWeight || '600';
                            linkElement.style.cursor = 'pointer';
                            
                            const textDiv = document.createElement('div');
                            textDiv.style.fontSize = `${youtubeStyles.fontSize || 17}px`;
                            textDiv.style.fontWeight = 'bold';
                            textDiv.textContent = link.name || 'Ïù¥Î¶Ñ ÏóÜÏùå';
                            
                            const liveIndicator = document.createElement('span');
                            liveIndicator.className = 'live-indicator';
                            liveIndicator.setAttribute('data-channel-url', link.url || '');
                            liveIndicator.style.position = 'absolute';
                            liveIndicator.style.top = '5px';
                            liveIndicator.style.right = '5px';
                            liveIndicator.style.width = '10px';
                            liveIndicator.style.height = '10px';
                            liveIndicator.style.borderRadius = '50%';
                            liveIndicator.style.background = '#666';
                            liveIndicator.style.animation = 'none';
                            
                            linkElement.appendChild(textDiv);
                            linkElement.appendChild(liveIndicator);
                            
                            // Ìò∏Î≤Ñ Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                            linkElement.addEventListener('mouseover', function() {
                                this.style.transform = 'translateY(-3px)';
                                this.style.borderColor = '#555';
                                if (youtubeStyles.hoverBg) {
                                    this.style.background = youtubeStyles.hoverBg;
                                }
                            });
                            
                            linkElement.addEventListener('mouseout', function() {
                                this.style.transform = 'translateY(0)';
                                this.style.borderColor = youtubeStyles.borderColor || '#333333';
                                this.style.background = youtubeStyles.bgColor || '#1a1a1a';
                            });
                            
                            youtubeContainer.appendChild(linkElement);
                        });

                        // YouTube ÎùºÏù¥Î∏å ÏÉÅÌÉú Ï≤¥ÌÅ¨
                        checkYouTubeLiveStatus();
                    } else {
                        const emptyMessage = document.createElement('div');
                        emptyMessage.style.color = '#666';
                        emptyMessage.style.textAlign = 'center';
                        emptyMessage.textContent = 'ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§. Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄÏóêÏÑú Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.';
                        youtubeContainer.appendChild(emptyMessage);
                    }
                }
                
                // Favorite ÎßÅÌÅ¨ Î†åÎçîÎßÅ
                const favoriteContainer = document.getElementById('favorite-links');
                if (favoriteContainer) {
                    favoriteContainer.innerHTML = ''; // Í∏∞Ï°¥ ÎÇ¥Ïö© Ï†úÍ±∞
                    
                    if (favoriteLinks.length > 0) {
                        const favoriteStyles = getCardStyles('favorite');
                        
                        favoriteLinks.forEach(link => {
                            const linkElement = document.createElement('a');
                            linkElement.href = link.url || '#';
                            linkElement.target = '_blank';
                            
                            // Ïä§ÌÉÄÏùº Ï†ÅÏö© (Í∞úÎ≥Ñ ÏÜçÏÑ±ÏúºÎ°ú ÏïàÏ†ÑÌïòÍ≤å)
                            linkElement.style.background = favoriteStyles.bgColor || '#1a1a1a';
                            linkElement.style.color = favoriteStyles.textColor || '#ffffff';
                            linkElement.style.padding = (favoriteStyles.padding || 15) + 'px';
                            linkElement.style.borderRadius = (favoriteStyles.borderRadius || 10) + 'px';
                            linkElement.style.textAlign = 'center';
                            linkElement.style.border = `${favoriteStyles.borderWidth || 1}px solid ${favoriteStyles.borderColor || '#333333'}`;
                            linkElement.style.textDecoration = 'none';
                            linkElement.style.transition = 'transform 0.3s ease';
                            linkElement.style.display = 'block';
                            linkElement.style.fontWeight = favoriteStyles.fontWeight || '500';
                            linkElement.style.cursor = 'pointer';
                            
                            const textDiv = document.createElement('div');
                            textDiv.style.fontSize = `${favoriteStyles.fontSize || 16}px`;
                            textDiv.textContent = link.name || 'Ïù¥Î¶Ñ ÏóÜÏùå';
                            
                            // Ìò∏Î≤Ñ Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                            linkElement.addEventListener('mouseover', function() {
                                this.style.transform = 'translateY(-3px)';
                                this.style.borderColor = '#555';
                                if (favoriteStyles.hoverBg) {
                                    this.style.background = favoriteStyles.hoverBg;
                                }
                            });
                            
                            linkElement.addEventListener('mouseout', function() {
                                this.style.transform = 'translateY(0)';
                                this.style.borderColor = favoriteStyles.borderColor || '#333333';
                                this.style.background = favoriteStyles.bgColor || '#1a1a1a';
                            });
                            
                            linkElement.appendChild(textDiv);
                            favoriteContainer.appendChild(linkElement);
                        });
                    } else {
                        const emptyMessage = document.createElement('div');
                        emptyMessage.style.color = '#666';
                        emptyMessage.style.textAlign = 'center';
                        emptyMessage.textContent = 'ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§. Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄÏóêÏÑú Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.';
                        favoriteContainer.appendChild(emptyMessage);
                    }
                }
                
                // Fun YouTube ÎßÅÌÅ¨ Î†åÎçîÎßÅ (Ïç∏ÎÑ§ÏùºÍ≥º Ïã§Ï†ú Ï†úÎ™© Ìè¨Ìï®)
                const funYoutubeListContainer = document.getElementById('fun-youtube-links-list');
                const funYoutubeGridContainer = document.getElementById('fun-youtube-links-grid');

                // Fun YouTube ÏÑ§Ï†ï Î°úÎìú
                const funYoutubeSettings = JSON.parse(localStorage.getItem('funYoutubeSettings') || '{}');
                const defaultSettings = {
                    viewMode: 'list',
                    gridColumns: 3,
                    showThumbnails: true,
                    showAuthor: false,
                    showViewButton: false,
                    fontSize: 16,
                    bgColor: '#1a1a1a',
                    textColor: '#ffffff',
                    hoverBgColor: '#2a2a2a',
                    borderRadius: 8,
                    hoverScale: true
                };
                const funSettings = { ...defaultSettings, ...funYoutubeSettings };

                // Ï¥àÍ∏∞ Î∑∞ Î™®Îìú ÏÑ§Ï†ï
                window.funYoutubeViewMode = funSettings.viewMode;

                if (funYoutubeListContainer && funYoutubeGridContainer) {
                    // Í∑∏Î¶¨Îìú Ïª¨Îüº ÏÑ§Ï†ï
                    if (funYoutubeGridContainer) {
                        funYoutubeGridContainer.style.gridTemplateColumns = `repeat(${funSettings.gridColumns}, 1fr)`;
                    }

                    if (funYoutubeLinks.length > 0) {
                        // Update view buttons to reflect current mode
                        const buttons = document.querySelectorAll('.fun-youtube-view-btn');
                        buttons.forEach(btn => {
                            btn.style.background = btn.getAttribute('data-view') === window.funYoutubeViewMode ? '#fff' : 'transparent';
                            btn.style.color = btn.getAttribute('data-view') === window.funYoutubeViewMode ? '#000' : '#999';
                        });

                        // Í∞Å ÎßÅÌÅ¨Ïóê ÎåÄÌï¥ YouTube Ï†ïÎ≥¥ Í∞ÄÏ†∏ÏôÄÏÑú Î†åÎçîÎßÅ
                        const renderFunYoutubeLinks = async () => {
                            if (window.funYoutubeViewMode === 'grid') {
                                // Í∑∏Î¶¨Îìú Î∑∞
                                funYoutubeListContainer.style.display = 'none';
                                funYoutubeGridContainer.style.display = 'grid';
                                funYoutubeGridContainer.innerHTML = '';

                                for (const link of funYoutubeLinks) {
                                    const videoInfo = await getYouTubeVideoInfo(link.url);
                                    const gridItem = document.createElement('a');
                                    gridItem.href = link.url;
                                    gridItem.target = '_blank';
                                    gridItem.style.cssText = `
                                        background: ${funSettings.bgColor};
                                        color: ${funSettings.textColor};
                                        border-radius: ${funSettings.borderRadius}px;
                                        border: 1px solid #333;
                                        text-decoration: none;
                                        transition: all 0.3s ease;
                                        display: block;
                                        overflow: hidden;
                                        cursor: pointer;
                                    `;
                                    // Ïç∏ÎÑ§Ïùº Î†åÎçîÎßÅ
                                    if (funSettings.showThumbnails && videoInfo.thumbnail) {
                                        const thumbnailContainer = document.createElement('div');
                                        thumbnailContainer.style.width = '100%';
                                        thumbnailContainer.style.aspectRatio = '16/9';
                                        thumbnailContainer.style.background = '#000';
                                        thumbnailContainer.style.overflow = 'hidden';
                                        thumbnailContainer.style.position = 'relative';
                                        
                                        const thumbnail = document.createElement('img');
                                        thumbnail.src = videoInfo.thumbnail || '';
                                        thumbnail.style.width = '100%';
                                        thumbnail.style.height = '100%';
                                        thumbnail.style.objectFit = 'cover';
                                        thumbnail.onerror = function() {
                                            this.src = 'https://via.placeholder.com/320x180?text=No+Thumbnail';
                                        };
                                        
                                        thumbnailContainer.appendChild(thumbnail);
                                        gridItem.appendChild(thumbnailContainer);
                                    }
                                    
                                    // ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† Î†åÎçîÎßÅ
                                    const contentDiv = document.createElement('div');
                                    contentDiv.style.padding = '12px';
                                    
                                    const titleDiv = document.createElement('div');
                                    titleDiv.style.fontSize = `${funSettings.fontSize || 16}px`;
                                    titleDiv.style.fontWeight = '600';
                                    titleDiv.style.marginBottom = '4px';
                                    titleDiv.style.display = '-webkit-box';
                                    titleDiv.style.webkitLineClamp = '2';
                                    titleDiv.style.webkitBoxOrient = 'vertical';
                                    titleDiv.style.overflow = 'hidden';
                                    titleDiv.style.lineHeight = '1.3';
                                    titleDiv.textContent = videoInfo.title || 'Ï†úÎ™© ÏóÜÏùå';
                                    contentDiv.appendChild(titleDiv);
                                    
                                    if (funSettings.showAuthor && videoInfo.author) {
                                        const authorDiv = document.createElement('div');
                                        authorDiv.style.fontSize = `${(funSettings.fontSize || 16) - 2}px`;
                                        authorDiv.style.color = '#999';
                                        authorDiv.style.marginTop = '4px';
                                        authorDiv.textContent = videoInfo.author;
                                        contentDiv.appendChild(authorDiv);
                                    }
                                    
                                    gridItem.appendChild(contentDiv);
                                    gridItem.onmouseover = function() {
                                        this.style.background = funSettings.hoverBgColor;
                                        if (funSettings.hoverScale) {
                                            this.style.transform = 'translateY(-2px)';
                                            this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
                                        }
                                    };
                                    gridItem.onmouseout = function() {
                                        this.style.background = funSettings.bgColor;
                                        if (funSettings.hoverScale) {
                                            this.style.transform = 'translateY(0)';
                                            this.style.boxShadow = 'none';
                                        }
                                    };
                                    funYoutubeGridContainer.appendChild(gridItem);
                                }
                            } else {
                                // Î¶¨Ïä§Ìä∏ Î∑∞
                                funYoutubeListContainer.style.display = 'flex';
                                funYoutubeGridContainer.style.display = 'none';
                                funYoutubeListContainer.innerHTML = '';

                                for (const link of funYoutubeLinks) {
                                    const videoInfo = await getYouTubeVideoInfo(link.url);
                                    const listItem = document.createElement('a');
                                    listItem.href = link.url;
                                    listItem.target = '_blank';
                                    listItem.style.cssText = `
                                        background: ${funSettings.bgColor};
                                        color: ${funSettings.textColor};
                                        padding: 12px;
                                        border: 1px solid #333;
                                        border-radius: ${funSettings.borderRadius}px;
                                        text-decoration: none;
                                        transition: all 0.2s ease;
                                        display: flex;
                                        gap: 15px;
                                        align-items: center;
                                        cursor: pointer;
                                        margin-bottom: 1px;
                                    `;
                                    // Ïç∏ÎÑ§Ïùº Î†åÎçîÎßÅ
                                    if (funSettings.showThumbnails && videoInfo.thumbnail) {
                                        const thumbnailContainer = document.createElement('div');
                                        thumbnailContainer.style.width = '160px';
                                        thumbnailContainer.style.height = '90px';
                                        thumbnailContainer.style.flexShrink = '0';
                                        thumbnailContainer.style.background = '#000';
                                        thumbnailContainer.style.overflow = 'hidden';
                                        thumbnailContainer.style.borderRadius = `${(funSettings.borderRadius || 8) / 2}px`;
                                        
                                        const thumbnail = document.createElement('img');
                                        thumbnail.src = videoInfo.thumbnail || '';
                                        thumbnail.style.width = '100%';
                                        thumbnail.style.height = '100%';
                                        thumbnail.style.objectFit = 'cover';
                                        thumbnail.onerror = function() {
                                            this.src = 'https://via.placeholder.com/160x90?text=No+Thumbnail';
                                        };
                                        
                                        thumbnailContainer.appendChild(thumbnail);
                                        listItem.appendChild(thumbnailContainer);
                                    }
                                    
                                    // ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† Î†åÎçîÎßÅ
                                    const contentDiv = document.createElement('div');
                                    contentDiv.style.flex = '1';
                                    contentDiv.style.minWidth = '0';
                                    
                                    const titleDiv = document.createElement('div');
                                    titleDiv.style.fontSize = `${funSettings.fontSize || 16}px`;
                                    titleDiv.style.fontWeight = '500';
                                    titleDiv.style.marginBottom = '4px';
                                    titleDiv.style.overflow = 'hidden';
                                    titleDiv.style.textOverflow = 'ellipsis';
                                    titleDiv.style.whiteSpace = 'nowrap';
                                    titleDiv.textContent = videoInfo.title || 'Ï†úÎ™© ÏóÜÏùå';
                                    contentDiv.appendChild(titleDiv);
                                    
                                    if (funSettings.showAuthor && videoInfo.author) {
                                        const authorDiv = document.createElement('div');
                                        authorDiv.style.fontSize = `${(funSettings.fontSize || 16) - 2}px`;
                                        authorDiv.style.color = '#999';
                                        authorDiv.textContent = videoInfo.author;
                                        contentDiv.appendChild(authorDiv);
                                    }
                                    
                                    listItem.appendChild(contentDiv);
                                    listItem.onmouseover = function() {
                                        this.style.background = funSettings.hoverBgColor;
                                        this.style.borderColor = '#444';
                                        if (funSettings.hoverScale) {
                                            this.style.transform = 'scale(1.01)';
                                        }
                                    };
                                    listItem.onmouseout = function() {
                                        this.style.background = funSettings.bgColor;
                                        this.style.borderColor = '#333';
                                        if (funSettings.hoverScale) {
                                            this.style.transform = 'scale(1)';
                                        }
                                    };
                                    funYoutubeListContainer.appendChild(listItem);
                                }
                            }
                        };

                        // ÎπÑÎèôÍ∏∞Î°ú Î†åÎçîÎßÅ Ïã§Ìñâ
                        renderFunYoutubeLinks();
                    } else {
                        // Îπà ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú
                        if (funYoutubeListContainer) {
                            funYoutubeListContainer.innerHTML = '';
                            const emptyMessage = document.createElement('div');
                            emptyMessage.style.color = '#666';
                            emptyMessage.style.textAlign = 'center';
                            emptyMessage.textContent = 'ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§. Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄÏóêÏÑú Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.';
                            funYoutubeListContainer.appendChild(emptyMessage);
                        }
                        if (funYoutubeGridContainer) {
                            funYoutubeGridContainer.innerHTML = '';
                        }
                    }
                }
                
                // Ïª§Ïä§ÌÖÄ Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑπÏÖò Î†åÎçîÎßÅ
                const customSectionsContainer = document.getElementById('custom-category-sections');
                if (customSectionsContainer && customCategories.length > 0) {
                    customSectionsContainer.innerHTML = '';
                    
                    customCategories.forEach(category => {
                        const categoryLinks = customCategoryLinks[category.id] || [];
                        
                        if (categoryLinks.length > 0) {
                            const section = document.createElement('div');
                            section.className = 'custom-category-section';
                            section.style.cssText = 'margin-top: 20px; padding-bottom: 20px;';
                            
                            // Ïπ¥ÌÖåÍ≥†Î¶¨ Ìó§Îçî ÏÉùÏÑ±
                            const header = document.createElement('h2');
                            header.style.color = '#aaa';
                            header.style.marginBottom = '20px';
                            header.style.paddingBottom = '10px';
                            header.style.borderBottom = '2px solid #333';
                            header.textContent = `üìå ${category.name || 'Ïù¥Î¶Ñ ÏóÜÏùå'}`;
                            section.appendChild(header);
                            
                            // ÎßÅÌÅ¨ Í∑∏Î¶¨Îìú Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
                            const linksGrid = document.createElement('div');
                            linksGrid.style.display = 'grid';
                            linksGrid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(150px, 1fr))';
                            linksGrid.style.gap = '15px';
                            
                            // Í∞Å ÎßÅÌÅ¨Î•º DOM ÏöîÏÜåÎ°ú ÏÉùÏÑ±
                            categoryLinks.forEach(link => {
                                const linkElement = document.createElement('a');
                                linkElement.href = link.url || '#';
                                linkElement.target = '_blank';
                                
                                // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Ïä§ÌÉÄÏùº Í∞ÄÏ†∏Ïò§Í∏∞
                                const categoryStyles = getCardStyles(category.id) || getCardStyles('gpt'); // Í∏∞Î≥∏Í∞íÏúºÎ°ú gpt Ïä§ÌÉÄÏùº ÏÇ¨Ïö©
                                
                                linkElement.style.cssText = `
                                    background: ${categoryStyles.bgColor || '#1a1a1a'};
                                    color: ${categoryStyles.textColor || '#ffffff'};
                                    padding: ${categoryStyles.padding || 15}px;
                                    border-radius: ${categoryStyles.borderRadius || 10}px;
                                    text-align: center;
                                    border: ${categoryStyles.borderWidth || 1}px solid ${categoryStyles.borderColor || '#333333'};
                                    text-decoration: none;
                                    transition: transform 0.3s ease;
                                    display: block;
                                    font-weight: ${categoryStyles.fontWeight || '500'};
                                    cursor: pointer;
                                `;
                                
                                const textDiv = document.createElement('div');
                                textDiv.style.fontSize = `${categoryStyles.fontSize || 16}px`;
                                textDiv.textContent = link.name || 'Ïù¥Î¶Ñ ÏóÜÏùå';
                                
                                // Ìò∏Î≤Ñ Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                                linkElement.addEventListener('mouseover', function() {
                                    this.style.transform = 'translateY(-3px)';
                                    this.style.borderColor = '#555';
                                    if (categoryStyles.hoverBg) {
                                        this.style.background = categoryStyles.hoverBg;
                                    }
                                });
                                
                                linkElement.addEventListener('mouseout', function() {
                                    this.style.transform = 'translateY(0)';
                                    this.style.borderColor = categoryStyles.borderColor || '#333333';
                                    this.style.background = categoryStyles.bgColor || '#1a1a1a';
                                });
                                
                                linkElement.appendChild(textDiv);
                                linksGrid.appendChild(linkElement);
                            });
                            
                            section.appendChild(linksGrid);
                            
                            customSectionsContainer.appendChild(section);
                        }
                    });
                }
                
            } catch (error) {
                console.error('üóÑÔ∏è === SECTION 3: ÎßÅÌÅ¨ Î°úÎìú Ïã§Ìå® ===');
                console.error('Error:', error);
                console.error('Error message:', error.message);
                console.error('Error stack:', error.stack);
                
                // Î™®Îì† Ïª®ÌÖåÏù¥ÎÑàÏóê ÏóêÎü¨ Î©îÏãúÏßÄ ÌëúÏãú
                const containers = [
                    { id: 'gpt-links', name: 'GPT ÎßÅÌÅ¨' },
                    { id: 'youtube-links', name: 'YouTube ÎßÅÌÅ¨' },
                    { id: 'favorite-links', name: 'Favorite ÎßÅÌÅ¨' },
                    { id: 'fun-youtube-links-list', name: 'Fun YouTube ÎßÅÌÅ¨' }
                ];
                
                containers.forEach(({ id, name }) => {
                    const container = document.getElementById(id);
                    if (container) {
                        const errorDiv = document.createElement('div');
                        errorDiv.style.cssText = `
                            color: #f87171;
                            text-align: center;
                            padding: 20px;
                            background: #1a1a1a;
                            border-radius: 10px;
                            border: 1px solid #333;
                        `;
                        errorDiv.innerHTML = `
                            <div>‚ùå ${name} Î°úÎìú Ïã§Ìå®</div>
                            <div style="font-size: 12px; margin-top: 5px; color: #888;">
                                ${error.message}
                            </div>
                            <button onclick="location.reload()" style="
                                margin-top: 10px;
                                padding: 5px 15px;
                                background: #333;
                                color: #fff;
                                border: 1px solid #555;
                                border-radius: 5px;
                                cursor: pointer;
                            ">ÏÉàÎ°úÍ≥†Ïπ®</button>
                        `;
                        container.innerHTML = '';
                        container.appendChild(errorDiv);
                    }
                });
                
                // Ï∂îÍ∞Ä ÎîîÎ≤ÑÍπÖ Ï†ïÎ≥¥ ÌëúÏãú
                alert(`ÏÑπÏÖò 3 Î°úÎìú Ïã§Ìå®: ${error.message}\n\nÎîîÎ≤ÑÍ∑∏ ÌéòÏù¥ÏßÄÏóêÏÑú ÏûêÏÑ∏Ìïú Ï†ïÎ≥¥Î•º ÌôïÏù∏ÌïòÏÑ∏Ïöî:\n/debug-section3.html`);
            }
        }
        
        // YouTube ÎùºÏù¥Î∏å ÏÉÅÌÉú Ï≤¥ÌÅ¨ Ìï®Ïàò
        async function checkYouTubeLiveStatus() {
            const indicators = document.querySelectorAll('.live-indicator');
            
            indicators.forEach(async (indicator) => {
                const channelUrl = indicator.getAttribute('data-channel-url');
                
                // URLÏóêÏÑú Ï±ÑÎÑê Ï†ïÎ≥¥ Ï∂îÏ∂ú
                try {
                    // CORS Ï†úÌïúÏúºÎ°ú Ïù∏Ìï¥ ÏßÅÏ†ë Ï≤¥ÌÅ¨Í∞Ä Ïñ¥Î†§Ïö∞ÎØÄÎ°ú,
                    // ÌîÑÎ°ùÏãú ÏÑúÎ≤ÑÎÇò YouTube APIÎ•º ÏÇ¨Ïö©Ìï¥Ïïº Ìï©ÎãàÎã§.
                    // ÏùºÎã® ÏãúÎÆ¨Î†àÏù¥ÏÖòÏúºÎ°ú Íµ¨ÌòÑ
                    
                    // Ïã§Ï†ú Íµ¨ÌòÑÏãú YouTube Data API v3 ÏÇ¨Ïö© ÌïÑÏöî
                    // Ïó¨Í∏∞ÏÑúÎäî URLÏóê '/live'Í∞Ä Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏúºÎ©¥ ÎùºÏù¥Î∏åÎ°ú Í∞ÄÏ†ï
                    const isLive = channelUrl.includes('/live');
                    
                    if (isLive) {
                        // ÎùºÏù¥Î∏å Ï§ë - Îπ®Í∞ÑÏÉâ Ïõê + ÍπúÎπ°ÏûÑ Ïï†ÎãàÎ©îÏù¥ÏÖò
                        indicator.style.background = '#ff0000';
                        indicator.style.animation = 'livePulse 1.5s infinite';
                        indicator.title = 'üî¥ LIVE';
                    } else {
                        // Ïò§ÌîÑÎùºÏù∏ - ÌöåÏÉâ Ïõê
                        indicator.style.background = '#666';
                        indicator.style.animation = 'none';
                        indicator.title = '‚ö´ Offline';
                    }
                } catch (error) {
                    console.error('ÎùºÏù¥Î∏å ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®:', error);
                }
            });
        }
        // ÌòÑÏû¨ Í∞ÄÍ≤© Ï∂îÏ†Å
        let currentPrices = {
            BTCUSDT: { high: 0, low: 999999999, current: 0 },
            ETHUSDT: { high: 0, low: 999999999, current: 0 },
            SOLUSDT: { high: 0, low: 999999999, current: 0 }
        };
        
        // Í≥µÌÜµ Supabase Ï†ÄÏû• Ìï®Ïàò
        // Ïû¨ÏãúÎèÑ Ïπ¥Ïö¥ÌÑ∞Î•º ÏúÑÌïú Ï†ÑÏó≠ Í∞ùÏ≤¥
        const retryCounters = {};
        
        async function saveToSupabase(symbol, date, high, low, close, retryCount = 0) {
            const MAX_RETRIES = 10;
            
            // window.supabaseClient ÌôïÏù∏
            if (!window.supabaseClient) {
                if (retryCount >= MAX_RETRIES) {
                    console.error(`Supabase Ï¥àÍ∏∞Ìôî Ïã§Ìå® (${MAX_RETRIES}Ìöå Ïû¨ÏãúÎèÑ ÌõÑ)`);
                    return;
                }
                console.log(`Supabase Ï¥àÍ∏∞Ìôî ÎåÄÍ∏∞ Ï§ë... (${retryCount + 1}/${MAX_RETRIES})`);
                setTimeout(() => saveToSupabase(symbol, date, high, low, close, retryCount + 1), 500);
                return;
            }
            
            try {
                const { error } = await window.supabaseClient
                    .from('price_history')
                    .upsert({
                        symbol: symbol,
                        date: date,
                        high_price: parseFloat(high),
                        low_price: parseFloat(low),
                        price: parseFloat(close)  // close_price -> priceÎ°ú ÏàòÏ†ï
                    }, {
                        onConflict: 'symbol,date'
                    });
                
                if (!error) {
                    if (symbol === 'BTCUSDT') loadBTCHistory();
                    else if (symbol === 'ETHUSDT') loadETHHistory();
                    else if (symbol === 'SOLUSDT') loadSOLHistory();
                }
            } catch (err) {
                console.error(`${symbol} Í∞ÄÍ≤© Ï†ÄÏû• Ïã§Ìå®:`, err);
            }
        }
        
        // BTC 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù Î∂àÎü¨Ïò§Í∏∞
        async function loadBTCHistory() {
            console.log('BTC Í∏∞Î°ù Î°úÎìú ÏãúÏûë');
            
            // window.supabaseClient ÌôïÏù∏
            if (!window.supabaseClient) {
                console.error('Supabase clientÍ∞Ä ÏïÑÏßÅ Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§');
                setTimeout(loadBTCHistory, 100);
                return;
            }
            
            try {
                const { data, error } = await window.supabaseClient
                    .from('price_history')
                    .select('*')
                    .eq('symbol', 'BTCUSDT')
                    .order('date', { ascending: false })
                    .limit(10);
                
                console.log('BTC Îç∞Ïù¥ÌÑ∞:', data);
                console.log('BTC ÏóêÎü¨:', error);
                
                if (error) throw error;
                
                const tbody = document.getElementById('btc-history-tbody');
                if (!tbody) {
                    console.error('btc-history-tbody ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                    return;
                }
                
                if (data && data.length > 0) {
                    tbody.innerHTML = data.map(record => {
                        // Í∞ÄÍ≤© Ìè¨Îß∑ Ìï®Ïàò (HTML ÏóÜÏù¥)
                        const formatPriceSimple = (price) => {
                            if (price === null || price === undefined || price === '') return '-';
                            const num = parseFloat(price);
                            if (isNaN(num)) return '-';
                            return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                        };
                        
                        const dateObj = new Date(record.date + 'T00:00:00');
                        const month = dateObj.getMonth() + 1;
                        const day = dateObj.getDate();
                        const dateStr = `${month}.${day}`;

                        return `
                        <tr style="border-bottom: 1px solid #222;">
                            <td style="padding: 8px; color: #888;">${dateStr}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.high_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.low_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.price || record.close_price)}</td>
                        </tr>`;
                    }).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" style="padding: 20px; text-align: center; color: #666;">ÏïÑÏßÅ Í∏∞Î°ùÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</td></tr>';
                }
            } catch (error) {
                console.error('BTC Í∏∞Î°ù Î°úÎìú Ïã§Ìå®:', error);
                const tbody = document.getElementById('btc-history-tbody');
                if (tbody) {
                    tbody.innerHTML = '<tr><td colspan="4" style="padding: 20px; text-align: center; color: #666;">Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§</td></tr>';
                }
            }
        }
        
        // ETH 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù Î∂àÎü¨Ïò§Í∏∞
        async function loadETHHistory() {
            // window.supabaseClient ÌôïÏù∏
            if (!window.supabaseClient) {
                console.error('Supabase clientÍ∞Ä ÏïÑÏßÅ Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§');
                setTimeout(loadETHHistory, 100);
                return;
            }
            
            try {
                const { data, error } = await window.supabaseClient
                    .from('price_history')
                    .select('*')
                    .eq('symbol', 'ETHUSDT')
                    .order('date', { ascending: false })
                    .limit(10);
                
                if (error) throw error;
                
                const tbody = document.getElementById('eth-history-tbody');
                if (!tbody) return;
                
                if (data && data.length > 0) {
                    tbody.innerHTML = data.map(record => {
                        // Í∞ÄÍ≤© Ìè¨Îß∑ Ìï®Ïàò (HTML ÏóÜÏù¥)
                        const formatPriceSimple = (price) => {
                            if (price === null || price === undefined || price === '') return '-';
                            const num = parseFloat(price);
                            if (isNaN(num)) return '-';
                            return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                        };
                        
                        const dateObj = new Date(record.date + 'T00:00:00');
                        const month = dateObj.getMonth() + 1;
                        const day = dateObj.getDate();
                        const dateStr = `${month}.${day}`;

                        return `
                        <tr style="border-bottom: 1px solid #222;">
                            <td style="padding: 8px; color: #888;">${dateStr}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.high_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.low_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.price || record.close_price)}</td>
                        </tr>`;
                    }).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" style="padding: 20px; text-align: center; color: #666;">ÏïÑÏßÅ Í∏∞Î°ùÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</td></tr>';
                }
            } catch (error) {
                console.error('ETH Í∏∞Î°ù Î°úÎìú Ïã§Ìå®:', error);
            }
        }
        
        // SOL 10Ïùº Í∞ÄÍ≤© Í∏∞Î°ù Î∂àÎü¨Ïò§Í∏∞
        async function loadSOLHistory() {
            // window.supabaseClient ÌôïÏù∏
            if (!window.supabaseClient) {
                console.error('Supabase clientÍ∞Ä ÏïÑÏßÅ Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§');
                setTimeout(loadSOLHistory, 100);
                return;
            }
            
            try {
                const { data, error } = await window.supabaseClient
                    .from('price_history')
                    .select('*')
                    .eq('symbol', 'SOLUSDT')
                    .order('date', { ascending: false })
                    .limit(10);
                
                if (error) throw error;
                
                const tbody = document.getElementById('sol-history-tbody');
                if (!tbody) return;
                
                if (data && data.length > 0) {
                    tbody.innerHTML = data.map(record => {
                        // Í∞ÄÍ≤© Ìè¨Îß∑ Ìï®Ïàò (HTML ÏóÜÏù¥)
                        const formatPriceSimple = (price) => {
                            if (price === null || price === undefined || price === '') return '-';
                            const num = parseFloat(price);
                            if (isNaN(num)) return '-';
                            return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                        };
                        
                        const dateObj = new Date(record.date + 'T00:00:00');
                        const month = dateObj.getMonth() + 1;
                        const day = dateObj.getDate();
                        const dateStr = `${month}.${day}`;

                        return `
                        <tr style="border-bottom: 1px solid #222;">
                            <td style="padding: 8px; color: #888;">${dateStr}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.high_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.low_price)}</td>
                            <td style="padding: 8px; text-align: right; color: #fff;">$${formatPriceSimple(record.price || record.close_price)}</td>
                        </tr>`;
                    }).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" style="padding: 20px; text-align: center; color: #666;">ÏïÑÏßÅ Í∏∞Î°ùÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</td></tr>';
                }
            } catch (error) {
                console.error('SOL Í∏∞Î°ù Î°úÎìú Ïã§Ìå®:', error);
            }
        }
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        // ÎÇòÏä§Îã• ÏßÄÏàò Í∞ÄÏ†∏Ïò§Í∏∞ (Yahoo Finance API ÎåÄÏ≤¥)
        async function fetchNasdaqData() {
            try {
                // Alpha Vantage Î¨¥Î£å API ÏÇ¨Ïö© (ÏùºÏùº Ï†úÌïú ÏûàÏùå)
                // ÎòêÎäî Îã§Î•∏ Î∞©Î≤ï: finnhub.io, twelvedata.com Îì±
                
                // Í∞ÑÎã®Ìïú ÎåÄÏ≤¥ Î∞©Î≤ï: Í≥†Ï†ïÍ∞í ÌëúÏãú ÎòêÎäî Ïô∏Î∂Ä API
                // Ïó¨Í∏∞ÏÑúÎäî ÏòàÏãúÎ°ú Í≥†Ï†ïÍ∞í ÌëúÏãú
                const nasdaqElement = document.getElementById('nasdaq-price');
                const changeElement = document.getElementById('nasdaq-change');
                const percentElement = document.getElementById('nasdaq-percent');
                
                // Ïã§ÏãúÍ∞Ñ APIÍ∞Ä ÌïÑÏöîÌïòÎ©¥ ÎÇòÏ§ëÏóê Ï∂îÍ∞Ä Í∞ÄÎä•
                // ÏòàÏãú Îç∞Ïù¥ÌÑ∞ (Ïã§Ï†úÎ°úÎäî APIÎ•º ÌÜµÌï¥ Í∞ÄÏ†∏ÏôÄÏïº Ìï®)
                if (nasdaqElement) {
                    // ÎûúÎç§ Î≥ÄÎèô ÏãúÎÆ¨Î†àÏù¥ÏÖò (ÏûÑÏãú)
                    const basePrice = 20000;
                    const variation = Math.random() * 200 - 100;
                    const currentPrice = basePrice + variation;
                    const change = variation;
                    const changePercent = (variation / basePrice * 100);
                    
                    nasdaqElement.innerHTML = formatPrice(currentPrice.toFixed(2));
                    nasdaqElement.classList.remove('loading');
                    
                    if (changeElement && percentElement) {
                        changeElement.innerHTML = `${change >= 0 ? '+' : ''}${change.toFixed(2)}`;
                        changeElement.style.color = change >= 0 ? '#4caf50' : '#f44336';
                        
                        percentElement.innerHTML = `${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(2)}%`;
                        percentElement.style.color = changePercent >= 0 ? '#4caf50' : '#f44336';
                    }
                }
            } catch (error) {
                console.error('NASDAQ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                const nasdaqElement = document.getElementById('nasdaq-price');
                if (nasdaqElement) {
                    nasdaqElement.innerHTML = 'N/A';
                    nasdaqElement.classList.remove('loading');
                }
            }
        }
        
        // ÏàúÏ∞®Ï†Å ÌéòÏù¥ÏßÄ Î°úÎî© ÏãúÏä§ÌÖú
        window.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ === ÏàúÏ∞®Ï†Å ÌéòÏù¥ÏßÄ Î°úÎî© ÏãúÏûë ===');
            
            try {
                // 1Îã®Í≥Ñ: Supabase Îç∞Ïù¥ÌÑ∞ Ïö∞ÏÑ† Î°úÎìú
                console.log('üìä 1Îã®Í≥Ñ: Supabase Îç∞Ïù¥ÌÑ∞ Î°úÎî©...');
                await loadSupabaseDataFirst();
                
                // 2Îã®Í≥Ñ: ÏãúÍ≥Ñ ÏãúÏûë
                console.log('üïê 2Îã®Í≥Ñ: ÏãúÍ≥Ñ ÏãúÏä§ÌÖú ÏãúÏûë...');
                startClockSystem();
                
                // 3Îã®Í≥Ñ: ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                console.log('üí∞ 3Îã®Í≥Ñ: ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎî©...');
                startCryptoSystem();
                
                // 4Îã®Í≥Ñ: Í∞ÄÍ≤© Í∏∞Î°ù Î°úÎìú
                console.log('üìà 4Îã®Í≥Ñ: Í∞ÄÍ≤© Í∏∞Î°ù Î°úÎî©...');
                loadHistoryData();
                
                console.log('‚úÖ === Î™®Îì† ÏãúÏä§ÌÖú Î°úÎî© ÏôÑÎ£å ===');
                
            } catch (error) {
                console.error('‚ùå ÌéòÏù¥ÏßÄ Î°úÎî© Ï§ë Ïò§Î•ò:', error);
                // Ïò§Î•ò Î∞úÏÉùÏãú Í∏∞Ï°¥ Î∞©ÏãùÏúºÎ°ú Ìè¥Î∞±
                fallbackLoading();
            }
        });
        
        // 1Îã®Í≥Ñ: Supabase Îç∞Ïù¥ÌÑ∞ Ïö∞ÏÑ† Î°úÎìú
        async function loadSupabaseDataFirst() {
            console.log('üóÑÔ∏è Supabase Îç∞Ïù¥ÌÑ∞ Ïö∞ÏÑ† Î°úÎî© ÏãúÏûë...');
            
            // Section 3 ÎßÅÌÅ¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            await loadLinksFromSupabase();
            
            // Ïã§ÏãúÍ∞Ñ Íµ¨ÎèÖ ÏÑ§Ï†ï
            setupRealtimeSubscription();
            
            // ÏûêÎèôÏúºÎ°ú GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ Ïã§Ìñâ
            setTimeout(() => {
                console.log('üîç ÏûêÎèô GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ Ïã§Ìñâ...');
                testGptLinksAbove();
            }, 2000);
            
            console.log('‚úÖ Supabase Îç∞Ïù¥ÌÑ∞ Î°úÎî© ÏôÑÎ£å');
        }
        
        // 2Îã®Í≥Ñ: ÏãúÍ≥Ñ ÏãúÏä§ÌÖú ÏãúÏûë
        function startClockSystem() {
            console.log('üïê ÏãúÍ≥Ñ ÏãúÏä§ÌÖú ÏãúÏûë...');
            
            // ÏãúÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë
            updateLastUpdate();
            
            // 1Ï¥àÎßàÎã§ ÏãúÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            setInterval(updateLastUpdate, 1000);
            
            console.log('‚úÖ ÏãúÍ≥Ñ ÏãúÏä§ÌÖú ÏãúÏûë ÏôÑÎ£å');
        }
        
        // 3Îã®Í≥Ñ: ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ ÏãúÏä§ÌÖú ÏãúÏûë
        function startCryptoSystem() {
            console.log('üí∞ ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ ÏãúÏä§ÌÖú ÏãúÏûë...');
            
            // Binance WebSocket Ïó∞Í≤∞ - Re-enabled for custom price cards
            connectBinance();
            
            console.log('‚úÖ ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ ÏãúÏä§ÌÖú ÏãúÏûë ÏôÑÎ£å');
        }
        
        // 4Îã®Í≥Ñ: Í∞ÄÍ≤© Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadHistoryData() {
            console.log('üìà Í∞ÄÍ≤© Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎî©...');
            
            loadBTCHistory(); // BTC Í∞ÄÍ≤© Í∏∞Î°ù Î°úÎìú
            loadETHHistory(); // ETH Í∞ÄÍ≤© Í∏∞Î°ù Î°úÎìú
            loadSOLHistory(); // SOL Í∞ÄÍ≤© Í∏∞Î°ù Î°úÎìú
            
            // ÎÇòÏä§Îã• Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            fetchNasdaqData();
            
            // Ï†ïÍ∏∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ§Ï†ï
            setInterval(fetchNasdaqData, 60000); // 1Î∂ÑÎßàÎã§ ÎÇòÏä§Îã• ÏóÖÎç∞Ïù¥Ìä∏
            
            // ÌòÑÏû¨ Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ Î∞îÎ°ú Ï†ÄÏû•
            setTimeout(() => {
                savePriceHistory();
            }, 5000); // 5Ï¥à ÌõÑ Ï≤´ Ï†ÄÏû•
            
            console.log('‚úÖ Í∞ÄÍ≤© Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎî© ÏôÑÎ£å');
        }
        
        // Ïã§ÏãúÍ∞Ñ Íµ¨ÎèÖ ÏÑ§Ï†ï
        function setupRealtimeSubscription() {
            setTimeout(() => {
                if (window.supabaseClient) {
                    console.log('üîÑ Supabase Ïã§ÏãúÍ∞Ñ Íµ¨ÎèÖ ÏÑ§Ï†ï Ï§ë...');
                    
                    // Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏ Íµ¨ÎèÖ (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                    const subscription = window.supabaseClient
                        .channel('links-channel')
                        .on('postgres_changes', 
                            { event: '*', schema: 'public', table: 'links' }, 
                            () => {
                                loadLinksFromSupabase(); // Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Î∞úÏÉùÏãú ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ®
                            }
                        )
                        .subscribe();
                    
                    // Í∞ÄÍ≤© Í∏∞Î°ù Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
                    const priceHistorySubscription = window.supabaseClient
                        .channel('price-history-channel')
                        .on('postgres_changes',
                            { event: '*', schema: 'public', table: 'price_history' },
                            (payload) => {
                                if (payload.new && payload.new.symbol === 'BTCUSDT') loadBTCHistory();
                                if (payload.new && payload.new.symbol === 'ETHUSDT') loadETHHistory();
                                if (payload.new && payload.new.symbol === 'SOLUSDT') loadSOLHistory();
                            }
                        )
                        .subscribe();
                    
                    console.log('‚úÖ Supabase Ïã§ÏãúÍ∞Ñ Íµ¨ÎèÖ ÏÑ§Ï†ï ÏôÑÎ£å');
                } else {
                    console.log('‚ö†Ô∏è Supabase Ïã§ÏãúÍ∞Ñ Íµ¨ÎèÖ Í±¥ÎÑàÎúÄ (ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏóÜÏùå)');
                }
            }, 2000);
        }
        
        // GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ Ìï®Ïàò (Ï†úÎ™© ÏúÑ ÏòÅÏó≠)
        async function testGptLinksAbove() {
            const testArea = document.getElementById('gpt-test-area');
            if (!testArea) {
                console.error('‚ùå gpt-test-area ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            testArea.innerHTML = '<div style="color: #4facfe;">üîç GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ Ï§ë...</div>';
            
            // ÏÉÅÏÑ∏ ÎîîÎ≤ÑÍπÖ Ï†ïÎ≥¥
            console.log('üîç === GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ ÏãúÏûë ===');
            console.log('Supabase ÎùºÏù¥Î∏åÎü¨Î¶¨:', typeof window.supabase);
            console.log('Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏:', typeof window.supabaseClient);
            console.log('ÌÖåÏä§Ìä∏ ÏòÅÏó≠ ÏöîÏÜå:', testArea);
            
            try {
                // Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÌôïÏù∏
                if (!window.supabaseClient) {
                    const errorMsg = '‚ùå Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏Í∞Ä ÏóÜÏäµÎãàÎã§';
                    testArea.innerHTML = `<div style="color: #f44336;">${errorMsg}</div>`;
                    console.error(errorMsg);
                    
                    // ÏàòÎèôÏúºÎ°ú Ï¥àÍ∏∞Ìôî ÏãúÎèÑ
                    try {
                        const SUPABASE_URL = 'https://ddfnxbkiewolgweivomv.supabase.co';
                        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZm54YmtpZXdvbGd3ZWl2b212Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MzI3NzYsImV4cCI6MjA2NzIwODc3Nn0.YCS2UH6YWarPX3C2ryFUUQnFA-3er_ZQomf_mccjmD8';
                        
                        if (window.supabase) {
                            window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                            testArea.innerHTML += '<div style="color: #fbbf24;">‚ö†Ô∏è ÏàòÎèô Ï¥àÍ∏∞Ìôî ÏãúÎèÑ Ï§ë...</div>';
                            console.log('‚úÖ ÏàòÎèôÏúºÎ°ú Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏÉùÏÑ±');
                        } else {
                            testArea.innerHTML += '<div style="color: #f44336;">‚ùå Supabase ÎùºÏù¥Î∏åÎü¨Î¶¨ ÏûêÏ≤¥Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
                            return;
                        }
                    } catch (initError) {
                        console.error('ÏàòÎèô Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', initError);
                        testArea.innerHTML += `<div style="color: #f44336;">‚ùå ÏàòÎèô Ï¥àÍ∏∞Ìôî Ïã§Ìå®: ${initError.message}</div>`;
                        return;
                    }
                }
                
                // Í∞ÑÎã®Ìïú GPT ÎßÅÌÅ¨ Ï°∞Ìöå
                const { data: gptLinks, error } = await window.supabaseClient
                    .from('links')
                    .select('*')
                    .eq('category', 'gpt')
                    .order('position', { ascending: true });
                
                if (error) {
                    testArea.innerHTML = `<div style="color: #f44336;">‚ùå Ïò§Î•ò: ${error.message}</div>`;
                    return;
                }
                
                console.log('üîç ÌÖåÏä§Ìä∏ ÏòÅÏó≠ GPT ÎßÅÌÅ¨:', gptLinks);
                
                if (!gptLinks || gptLinks.length === 0) {
                    testArea.innerHTML = '<div style="color: #fbbf24;">‚ö†Ô∏è GPT ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
                    return;
                }
                
                // ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Í∞ÄÏ†∏Ïò® Í≤ΩÏö∞ Í∞ÑÎã®Ìûà ÌëúÏãú
                let html = `<div style="color: #4caf50; margin-bottom: 10px;">‚úÖ GPT ÎßÅÌÅ¨ ${gptLinks.length}Í∞ú Î∞úÍ≤¨!</div>`;
                
                gptLinks.forEach((link, index) => {
                    html += `
                        <div style="background: #2a2a2a; padding: 10px; margin: 5px 0; border-radius: 5px; border: 1px solid #444;">
                            <a href="${link.url || '#'}" target="_blank" style="color: #4facfe; text-decoration: none; font-weight: bold;">
                                ${index + 1}. ${link.name || 'Ïù¥Î¶Ñ ÏóÜÏùå'}
                            </a>
                            <div style="color: #888; font-size: 11px; margin-top: 5px;">
                                ID: ${link.id}, Position: ${link.position}
                            </div>
                        </div>
                    `;
                });
                
                testArea.innerHTML = html;
                
            } catch (error) {
                testArea.innerHTML = `<div style="color: #f44336;">‚ùå ÏòàÏô∏ Î∞úÏÉù: ${error.message}</div>`;
                console.error('GPT ÎßÅÌÅ¨ ÌÖåÏä§Ìä∏ Ïò§Î•ò:', error);
            }
        }
        
        // Ìè¥Î∞± Î°úÎî© (Ïò§Î•òÏãú Í∏∞Ï°¥ Î∞©Ïãù)
        function fallbackLoading() {
            console.log('üîÑ Ìè¥Î∞± Î°úÎî© ÏãúÏûë...');
            
            // Í∏∞Ï°¥ Î∞©ÏãùÏúºÎ°ú Î™®Îì† Í≤ÉÏùÑ ÎèôÏãúÏóê Î°úÎìú
            setTimeout(() => {
                loadLinksFromSupabase();
            }, 1000);
            
            loadBTCHistory();
            loadETHHistory();
            loadSOLHistory();
            fetchNasdaqData();
            
            // connectBinance(); // DISABLED - Using TradingView Widget
            
            setInterval(fetchNasdaqData, 60000);
            
            setTimeout(() => {
                savePriceHistory();
            }, 5000);
            
            setupRealtimeSubscription();
        }
        
        // TradingView ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄÎ°úÎ∂ÄÌÑ∞ Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ ÏàòÏã†
        window.addEventListener('message', function(event) {
            if (event.data.type === 'TRADINGVIEW_PRICE_UPDATE') {
                console.log('üìà TradingViewÏóêÏÑú Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ ÏàòÏã†:', event.data.data);
                
                // Î∞õÏùÄ Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞Î°ú Î©îÏù∏ ÌéòÏù¥ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
                updateMainPagePrices(event.data.data);
                
                // ÏïåÎ¶º ÌëúÏãú
                showPriceUpdateNotification();
            }
        });
        
        // Î©îÏù∏ ÌéòÏù¥ÏßÄ Í∞ÄÍ≤© ÏóÖÎç∞Ïù¥Ìä∏
        function updateMainPagePrices(tradingViewData) {
            Object.keys(tradingViewData).forEach(symbol => {
                const data = tradingViewData[symbol];
                const price = data.price;
                
                // Ïã¨Î≥ºÏóê Îî∞Îùº Ìï¥Îãπ ÏöîÏÜå ÏóÖÎç∞Ïù¥Ìä∏
                if (symbol === 'BTCUSDT') {
                    const btcElement = document.getElementById('binance-btc');
                    if (btcElement) {
                        btcElement.innerHTML = formatPrice(price);
                        btcElement.style.color = data.change >= 0 ? '#4caf50' : '#f44336';
                    }
                } else if (symbol === 'ETHUSDT') {
                    const ethElement = document.getElementById('binance-eth');
                    if (ethElement) {
                        ethElement.innerHTML = formatPrice(price);
                        ethElement.style.color = data.change >= 0 ? '#4caf50' : '#f44336';
                    }
                } else if (symbol === 'SOLUSDT') {
                    const solElement = document.getElementById('binance-sol');
                    if (solElement) {
                        solElement.innerHTML = formatPrice(price);
                        solElement.style.color = data.change >= 0 ? '#4caf50' : '#f44336';
                    }
                } else if (symbol === 'XRPUSDT') {
                    const xrpElement = document.getElementById('binance-xrp');
                    if (xrpElement) {
                        xrpElement.innerHTML = formatPrice(price);
                        xrpElement.style.color = data.change >= 0 ? '#4caf50' : '#f44336';
                    }
                }
            });
        }
        
        // Í∞ÄÍ≤© ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º ÌëúÏãú
        function showPriceUpdateNotification() {
            // ÏûÑÏãú ÏïåÎ¶º ÌëúÏãú
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4facfe;
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                font-weight: bold;
                z-index: 10000;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
            `;
            notification.textContent = 'üìà TradingView Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏Îê®!';
            
            document.body.appendChild(notification);
            
            // 3Ï¥à ÌõÑ Ï†úÍ±∞
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // 5Î∂ÑÎßàÎã§ YouTube ÎùºÏù¥Î∏å ÏÉÅÌÉú Ïû¨ÌôïÏù∏
        setInterval(() => {
            checkYouTubeLiveStatus();
        }, 300000);

        // Ïó∞Í≤∞ ÏÉÅÌÉú Ï≤¥ÌÅ¨ (30Ï¥àÎßàÎã§)
        setInterval(() => {
            if (binanceBtcWs && binanceBtcWs.readyState !== WebSocket.OPEN) {
                // connectBinance(); // DISABLED - Using TradingView Widget
            }
        }, 30000);
        
        // Í∞ÄÍ≤© Í∏∞Î°ù Ï†ÄÏû• Ìï®Ïàò (5Î∂ÑÎßàÎã§ ÏûêÎèô Ïã§Ìñâ)
        async function savePriceHistory() {
            const today = new Date().toISOString().split('T')[0];
            console.log('Í∞ÄÍ≤© Í∏∞Î°ù ÏûêÎèô Ï†ÄÏû•:', today, currentPrices);

            // BTC Ï†ÄÏû•
            if (currentPrices.BTCUSDT && currentPrices.BTCUSDT.current > 0) {
                await saveToSupabase('BTCUSDT', today,
                    currentPrices.BTCUSDT.high || currentPrices.BTCUSDT.current,
                    currentPrices.BTCUSDT.low || currentPrices.BTCUSDT.current,
                    currentPrices.BTCUSDT.current);
            }

            // ETH Ï†ÄÏû•
            if (currentPrices.ETHUSDT && currentPrices.ETHUSDT.current > 0) {
                await saveToSupabase('ETHUSDT', today,
                    currentPrices.ETHUSDT.high, 
                    currentPrices.ETHUSDT.low, 
                    currentPrices.ETHUSDT.current);
            }
            
            // SOL Ï†ÄÏû•
            if (currentPrices.SOLUSDT && currentPrices.SOLUSDT.current > 0) {
                await saveToSupabase('SOLUSDT', today,
                    currentPrices.SOLUSDT.high, 
                    currentPrices.SOLUSDT.low, 
                    currentPrices.SOLUSDT.current);
            }
        }
        
        // 5Î∂ÑÎßàÎã§ Ïã§Ìñâ
        setInterval(savePriceHistory, 300000);

        // Ï¥àÍ∏∞ Ïã§Ìñâ (20Ï¥à ÌõÑ - WebSocket Ïó∞Í≤∞ ÌõÑ)
        setTimeout(savePriceHistory, 20000);

        // ÏàòÎèô ÏÉàÎ°úÍ≥†Ïπ® Ìï®Ïàò
        async function refreshPriceHistory() {
            console.log('Í∞ÄÍ≤© Í∏∞Î°ù ÏàòÎèô ÏÉàÎ°úÍ≥†Ïπ® ÏãúÏûë');

            // ÌòÑÏû¨ Í∞ÄÍ≤© Ï¶âÏãú Ï†ÄÏû•
            await savePriceHistory();

            // Ïû†Ïãú ÎåÄÍ∏∞ ÌõÑ Îç∞Ïù¥ÌÑ∞ Îã§Ïãú Î°úÎìú
            setTimeout(() => {
                loadBTCHistory();
                loadETHHistory();
                loadSOLHistory();
            }, 1000);
        }

        // Ï†ÑÏó≠ Ïä§ÏΩîÌîÑÏóê ÎÖ∏Ï∂ú
        window.refreshPriceHistory = refreshPriceHistory;
        
        // World clock update function for bottom clock
        function updateWorldClock() {
            const clockContainer = document.getElementById('clock-container');
            if (!clockContainer) return;
            
            const timezones = [
                { name: 'KOR', tz: 'Asia/Seoul', flag: 'kr' },
                { name: 'SYD', tz: 'Australia/Sydney', flag: 'au' },
                { name: 'DXB', tz: 'Asia/Dubai', flag: 'ae' },
                { name: 'LON', tz: 'Europe/London', flag: 'gb' },
                { name: 'NYC', tz: 'America/New_York', flag: 'us' }
            ];

            clockContainer.innerHTML = timezones.map(zone => {
                const now = new Date();
                const time = new Date(now.toLocaleString("en-US", { timeZone: zone.tz }));
                const hours = time.getHours().toString().padStart(2, '0');
                const minutes = time.getMinutes().toString().padStart(2, '0');
                const seconds = time.getSeconds().toString().padStart(2, '0');
                
                return `
                    <div style="
                        background: #1a1a1a;
                        border: 1px solid #333;
                        border-radius: 10px;
                        padding: 15px;
                        text-align: center;
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onclick="window.open('fullscreen-clock.html?tz=${zone.tz}', '_blank')"
                       onmouseover="this.style.transform='scale(1.05)'; this.style.borderColor='#555'"
                       onmouseout="this.style.transform='scale(1)'; this.style.borderColor='#333'">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 10px;">
                            <img src="https://flagcdn.com/24x18/${zone.flag}.png" 
                                 alt="${zone.name}"
                                 style="width: 24px; height: 18px; border-radius: 2px;">
                            <span style="color: #888; font-size: 0.9em; font-weight: bold;">${zone.name}</span>
                        </div>
                        <div style="font-size: 1.2em; font-weight: bold; color: #fff;">
                            ${hours}:${minutes}<span style="font-size: 0.7em; color: #666;">:${seconds}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // Update world clock every second
        setInterval(updateWorldClock, 1000);
        updateWorldClock(); // Initial call
    </script>
    
    <!-- Í¥ÄÎ¶¨Ïûê ÏÑ§Ï†ï Î≤ÑÌäº -->
    <a href="admin-v3.html" class="settings-btn" title="Í¥ÄÎ¶¨Ïûê ÏÑ§Ï†ï">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M12 1v6m0 6v6m4.22-13.22l4.24 4.24M1.54 1.54l4.24 4.24M20.46 20.46l-4.24-4.24M1.54 20.46l4.24-4.24M22 12h-6m-6 0H1"></path>
        </svg>
    </a>
    
    <style>
        .settings-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        
        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            transform: rotate(90deg);
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
        }
        
        .settings-btn svg {
            width: 24px;
            height: 24px;
        }
        
        /* Î™®Î∞îÏùº ÎåÄÏùë */
        @media (max-width: 768px) {
            .settings-btn {
                bottom: 20px;
                right: 20px;
                width: 45px;
                height: 45px;
            }
            
            .settings-btn svg {
                width: 20px;
                height: 20px;
            }
        }
    </style>
</body>
</html>